import{C as _}from"./ContentWrapper-DlMdTUjN.js";import{F as A}from"./FloatingButton-4QL0ZM1x.js";import{d as H,f as I,Q as q,r as o,i as D,p as K,w as r,o as x,a as u,k as l,u as t,t as h,b as T,c as N,l as U,m as Q}from"./index-bioeAiyt.js";import{s as $}from"./index-piERbzvQ.js";import{s as W}from"./index-CD8Q60NI.js";import{s as m}from"./index-rh8fCLP3.js";import{s as y}from"./index-gvbM66lU.js";import{s as C,a as Y}from"./index-Cng0D3wH.js";import{s as J}from"./index-DkVELwIv.js";import{s as w}from"./index-BG325Is8.js";import{s as O}from"./index-L43QG1jP.js";import{u as g}from"./materiModel-DIsyrgi0.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DhhDt_K-.js";import"./index-bhv4XlLD.js";import"./index-CcbwDcOD.js";import"./index-CW6tAiIF.js";import"./index-Bgv-j1VE.js";import"./index-Bijw0uEp.js";import"./index-t--hEgTQ.js";const X={style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"0.5rem","padding-left":"15px"}},Z=["onFocusout","contenteditable"],aa=["onClick"],ea=["onClick"],la={style:{display:"flex","flex-flow":"column",gap:"0.5rem"}},ta=H({__name:"Materi",setup(ia){const s=I(),E=q(),p=o(!1),f=o(!1),n=o({name:"",capaian:"",tujuan:""}),B=o([]),z=()=>{if(!n.value.name||!n.value.capaian||!n.value.tujuan){s.add({severity:"warn",summary:"Peringatan",detail:"Semua field harus diisi",life:3e3});return}g().createMateri(n.value).then(i=>{s.add({severity:"success",summary:"Berhasil",detail:"Materi berhasil dibuat",life:3e3}),f.value=!1}).catch(i=>{s.add({severity:"error",summary:"Error",detail:"Gagal membuat materi",life:3e3})}).finally(()=>{f.value=!1,n.value={name:"",capaian:"",tujuan:""},c()})},V=o(""),v=o(!1),b=o(!1),j=o(""),k=o(""),G=(i,a)=>{V.value=a,j.value=i,v.value=!0},L=(i,a)=>{V.value=a,k.value=i,b.value=!0},c=()=>{g().getMateri().then(i=>{B.value=i}).catch(i=>{s.add({severity:"error",summary:"Error",detail:"Gagal mengambil data materi",life:3e3})})},P=i=>{let a={_id:V.value};a[i]=i==="capaian"?j.value:k.value,g().updateMateri(a).then(d=>{s.add({severity:"success",summary:"Berhasil",detail:"Materi berhasil diperbarui",life:3e3})}).catch(d=>{s.add({severity:"error",summary:"Error",detail:"Gagal memperbarui materi",life:3e3})}).finally(()=>{i==="capaian"?v.value=!1:b.value=!1,c()})},F=i=>{E.require({message:"Apakah Anda yakin ingin menghapus materi ini?",header:"Konfirmasi Hapus",icon:"pi pi-exclamation-triangle",acceptLabel:"Ya, Hapus",rejectLabel:"Batal",acceptClass:"p-button-danger",rejectClass:"p-button-secondary",accept:()=>{g().deleteMateri({_id:i}).then(()=>{s.add({severity:"success",summary:"Berhasil",detail:"Materi berhasil dihapus",life:3e3}),c()}).catch(a=>{s.add({severity:"error",summary:"Error",detail:"Gagal menghapus materi",life:3e3})})},reject:()=>{}})},S=(i,a)=>{const d=a.target.textContent.trim();d?g().updateMateri({_id:i,name:d}).then(()=>{s.add({severity:"success",summary:"Berhasil",detail:"Nama materi berhasil diperbarui",life:3e3}),c()}).catch(e=>{s.add({severity:"error",summary:"Error",detail:"Gagal memperbarui nama materi",life:3e3})}):(s.add({severity:"warn",summary:"Peringatan",detail:"Nama materi tidak boleh kosong",life:3e3}),a.target.focus())};return D(()=>{c()}),(i,a)=>{const d=Q("fasicon");return x(),K(_,{"content-title":"Materi"},{default:r(()=>[u("div",X,[a[15]||(a[15]=u("span",null,"Mode edit: ",-1)),l(t(J),{modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=e=>p.value=e),onLabel:"Tambah Materi",offLabel:"Tambah Materi",class:"p-mb-2"},null,8,["modelValue"])]),l(t(W)),l(t(Y),{value:B.value,class:"p-datatable-striped"},{default:r(()=>[l(t(C),{style:{"font-weight":"bold","font-size":"13px",width:"220px"},header:"Nama Materi"},{body:r(({data:e})=>[u("span",{spellcheck:"false",onFocusout:M=>S(e._id,M),contenteditable:p.value},h(e.name),41,Z)]),_:1}),l(t(C),{header:"Capaian Pembelajaran",style:{"font-size":"13px"}},{body:r(({data:e})=>[T(h(e.capaian.length<5?e.capaian:e.capaian.split(" ").slice(0,5).join(" ")+"...")+" ",1),p.value?(x(),N("a",{key:0,onClick:M=>G(e.capaian,e._id),href:"javascript:;",style:{color:"orange"},class:"editcontent"},[l(d,{icon:"edit"})],8,aa)):U("",!0)]),_:1}),l(t(C),{header:"Tujuan Pembelajaran",style:{"font-size":"13px"}},{body:r(({data:e})=>[T(h(e.tujuan.length<5?e.tujuan:e.tujuan.split(" ").slice(0,5).join(" ")+"...")+" ",1),p.value?(x(),N("a",{key:0,onClick:M=>L(e.tujuan,e._id),href:"javascript:;",style:{color:"orange"},class:"editcontent"},[l(d,{icon:"edit"})],8,ea)):U("",!0)]),_:1}),l(t(C),{header:"Aksi",style:{"font-size":"13px"}},{body:r(({data:e})=>[l(t(m),{disabled:!p.value,icon:"pi pi-trash",class:"p-button-danger p-button-text",onClick:M=>F(e._id)},null,8,["disabled","onClick"])]),_:1})]),_:1},8,["value"]),l(t($),{visible:f.value,"onUpdate:visible":a[5]||(a[5]=e=>f.value=e),header:"Tambah Materi",modal:"",style:{width:"40vw"},maximizable:"",draggable:!1},{footer:r(()=>[l(t(m),{label:"Batal",onClick:a[4]||(a[4]=e=>f.value=!1),class:"p-button-text"}),l(t(m),{label:"Simpan",onClick:z,class:"p-button-primary"})]),default:r(()=>[u("div",la,[l(t(y),null,{default:r(()=>[a[16]||(a[16]=u("label",null,"Nama Materi",-1)),l(t(O),{modelValue:n.value.name,"onUpdate:modelValue":a[1]||(a[1]=e=>n.value.name=e),placeholder:"Masukkan nama materi",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(t(y),null,{default:r(()=>[a[17]||(a[17]=u("label",null,"Capaian Pembelajaran",-1)),l(t(w),{modelValue:n.value.capaian,"onUpdate:modelValue":a[2]||(a[2]=e=>n.value.capaian=e),placeholder:"Masukkan capaian pembelajaran",rows:"5",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(t(y),null,{default:r(()=>[a[18]||(a[18]=u("label",null,"Tujuan Pembelajaran",-1)),l(t(w),{modelValue:n.value.tujuan,"onUpdate:modelValue":a[3]||(a[3]=e=>n.value.tujuan=e),placeholder:"Masukkan tujuan pembelajaran",rows:"5",style:{width:"100%"}},null,8,["modelValue"])]),_:1})])]),_:1},8,["visible"]),l(t($),{visible:v.value,"onUpdate:visible":a[9]||(a[9]=e=>v.value=e),header:"Edit Capaian Pembelajaran",modal:"",style:{width:"40vw"},maximizable:"",draggable:!1},{footer:r(()=>[l(t(m),{label:"Batal",onClick:a[7]||(a[7]=e=>v.value=!1),class:"p-button-text"}),l(t(m),{label:"Simpan",onClick:a[8]||(a[8]=e=>P("capaian")),class:"p-button-primary"})]),default:r(()=>[l(t(y),null,{default:r(()=>[a[19]||(a[19]=u("label",null,"Capaian Pembelajaran",-1)),l(t(w),{modelValue:j.value,"onUpdate:modelValue":a[6]||(a[6]=e=>j.value=e),placeholder:"Masukkan capaian pembelajaran",rows:"20",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["visible"]),l(t($),{visible:b.value,"onUpdate:visible":a[13]||(a[13]=e=>b.value=e),header:"Edit Tujuan Pembelajaran",modal:"",style:{width:"40vw"},maximizable:"",draggable:!1},{footer:r(()=>[l(t(m),{label:"Batal",onClick:a[11]||(a[11]=e=>b.value=!1),class:"p-button-text"}),l(t(m),{label:"Perbarui",onClick:a[12]||(a[12]=e=>P("tujuan")),class:"p-button-primary"})]),default:r(()=>[l(t(y),null,{default:r(()=>[a[20]||(a[20]=u("label",null,"Tujuan Pembelajaran",-1)),l(t(w),{modelValue:k.value,"onUpdate:modelValue":a[10]||(a[10]=e=>k.value=e),placeholder:"Masukkan tujuan pembelajaran",rows:"20",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["visible"]),l(A,{onClick:a[14]||(a[14]=e=>f.value=!0)})]),_:1})}}}),xa=R(ta,[["__scopeId","data-v-774fa364"]]);export{xa as default};
