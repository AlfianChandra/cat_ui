/* empty css                  */import{d as X}from"./jwt-DHQMwwia.js";import{t as E}from"./testSessionModel-9TdrJDbP.js";import{i as F,S as Z,d as ee,r as d,f as te,P as se,Q as J,c as a,a as s,l as b,k as l,t as w,b as v,m as ne,F as S,O as q,u as k,w as I,o}from"./index-GPuS0P4G.js";import{s as A}from"./index-CgT_lfSS.js";import{s as ae}from"./index-DC67B2fT.js";import{s as oe}from"./index-y1oIo8on.js";import{h as B}from"./moment-C5S46NFB.js";import{s as ie}from"./index-Bnj71vIl.js";import{s as le}from"./index-Bu1hp7_a.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-t--hEgTQ.js";import"./index-B2yYq3rf.js";import"./index-Bi1Y1-xo.js";const de=(h,x={})=>{const{maxIdleTime:L=30}=x;let r=null;const y=()=>{r&&clearTimeout(r),r=setTimeout(()=>{h("Idle too long (possibly cheating)")},L*1e3)},f=()=>{document.hidden&&h("User switched tab or minimized the window")},_=p=>{p.preventDefault(),h("Right click is disabled")},u=p=>{const T=["F12","Control+Shift+I","Control+Shift+J","Control+U","Meta+Option+I"],z=[p.ctrlKey?"Control":"",p.metaKey?"Meta":"",p.shiftKey?"Shift":"",p.altKey?"Alt":"",p.key].filter(Boolean).join("+");(T.includes(z)||T.includes(p.key))&&(p.preventDefault(),h(`Blocked key combo detected: ${z}`))},C=p=>{p.preventDefault(),h("Copy/Paste action blocked")},$=()=>{h("Window resized â€” Possible multi-monitor cheating")},g=()=>{window.addEventListener("blur",f),document.addEventListener("visibilitychange",f),document.addEventListener("contextmenu",_),document.addEventListener("keydown",u),document.addEventListener("copy",C),document.addEventListener("paste",C),window.addEventListener("resize",$),window.addEventListener("mousemove",y),window.addEventListener("keypress",y),y()},c=()=>{window.removeEventListener("blur",f),document.removeEventListener("visibilitychange",f),document.removeEventListener("contextmenu",_),document.removeEventListener("keydown",u),document.removeEventListener("copy",C),document.removeEventListener("paste",C),window.removeEventListener("resize",$),window.removeEventListener("mousemove",y),window.removeEventListener("keypress",y),clearTimeout(r)};F(g),Z(c)},ue={class:"main-layer"},ce={key:0,class:"ly-flex-col"},me={style:{"text-align":"center",margin:"0",padding:"0"}},pe={style:{"font-size":"24px"}},ve={class:"ly-flex-row",style:{"margin-top":"1rem",gap:"0.5rem"}},fe={class:"ly-col",style:{width:"70%","box-sizing":"border-box",border:"1px solid #ccc",padding:"20px","border-radius":"10px",position:"relative"}},ye={key:0},ge={style:{margin:"0","margin-bottom":"1rem"}},we={key:0,style:{"margin-bottom":"1rem",border:"1px solid #ccc",padding:"20px","border-radius":"10px",display:"flex","flex-flow":"column","justify-content":"center","align-items":"center"}},he={style:{"margin-bottom":"1rem"}},be=["onClick","src"],ke={style:{"font-size":"11px"}},xe={style:{display:"block",width:"100%"}},_e=["innerHTML"],Ce={style:{display:"flex","flex-flow":"column","margin-top":"1rem"}},Le=["onClick"],Te=["innerHTML"],Ee={style:{margin:"0"}},Se={style:{margin:"0","margin-top":"0.5rem","font-size":"10px",color:"#888"}},Ie={key:1,style:{display:"flex","flex-flow":"column","justify-content":"center","align-items":"center",position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}},$e={class:"ly-col",style:{width:"30%","box-sizing":"border-box",border:"1px solid #ccc",padding:"20px","border-radius":"10px"}},ze={class:"soal-map",style:{width:"100%",display:"flex","flex-flow":"row wrap","justify-content":"space-around",gap:"1rem",position:"relative"}},Ke={key:0,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",display:"flex","flex-flow":"row nowrap","align-items":"center","justify-content":"center"}},je={style:{"font-size":"13px"}},De={key:1,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",display:"flex","flex-flow":"row nowrap","align-items":"center","justify-content":"center",background:"#f44336",color:"#fff","border-radius":"10px"}},Me={style:{"font-size":"13px"}},qe={key:2,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",display:"flex","flex-flow":"row nowrap","align-items":"center","justify-content":"center",background:"#4caf50",color:"#fff","border-radius":"10px"}},Pe={style:{"font-size":"13px"}},Ve={key:3,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",display:"flex","flex-flow":"row nowrap","align-items":"center","justify-content":"center",background:"#2196f3",color:"#fff","border-radius":"10px"}},Ae={style:{"font-size":"13px"}},Be={key:0,class:"img-enl"},Ue=["src"],Je=ee({__name:"ClientAssessmentSession",setup(h){const x=d(0),L=d(null),r=d({}),y=d([]),f=d(null),_=d(""),u=te(),C=se(),$=d(localStorage.getItem("authToken")||""),g=d({current_question:1,current_level:1}),c=d({id_user:X($.value).id,test_token:localStorage.getItem("testToken")||"",test_data:{}});de(n=>{u.add({severity:"error",summary:"ðŸš¨ Cheating Attempt Detected!",detail:n,life:3e3}),console.log("Cheat Attempt:",n)},{maxIdleTime:60});const T=()=>new Promise((n,e)=>{const i=c.value;E().getSessionData(i).then(t=>{c.value.test_data=t,f.value&&clearInterval(f.value),f.value=setInterval(()=>{const m=new Date,V=B(c.value.test_data.end_time),M=B.duration(V.diff(m));_.value=`0${M.hours()}:${M.minutes()}:${M.seconds()}`.replace(/:0(\d)/,":$1"),M.asSeconds()<=0&&(clearInterval(f.value),E().setAsCompleted({test_token:c.value.test_token}).then(()=>{u.add({severity:"success",summary:"Selesai",detail:"Tes telah selesai.",life:3e3}),window.location.href="/assessment/session"}).catch(Y=>{u.add({severity:"error",summary:"Kesalahan",detail:Y.message,life:3e3})}))},500),y.value=t.question_map.map(m=>({no:m.no,answered:m.answered,current:!1})),n(null)}).catch(t=>{t.status===404&&(localStorage.removeItem("testToken"),window.location.href="/assessment"),t.state!=null||t.state==="not_started"?(u.add({severity:"error",summary:"Kesalahan",detail:t.message,life:3e3}),window.location.href="/assessment"):u.add({severity:"error",summary:"Kesalahan",detail:t.message,life:3e3}),e(t)})}),z=()=>{const n={test_token:c.value.test_token};E().getCurrentState(n).then(e=>{g.value=e}).catch(e=>{e.status===404&&(localStorage.removeItem("testToken"),window.location.href="/assessment"),u.add({severity:"error",summary:"Kesalahan",detail:e,life:3e3})})},H=()=>{z()},N=()=>{const n={test_token:c.value.test_token,current_question:g.value.current_question,current_level:g.value.current_level};E().getQuestion(n).then(e=>{const i=e.no;r.value=e,y.value.forEach(t=>{t.no===i?t.current=!0:t.current=!1}),L.value=setInterval(()=>{x.value+=1},1e3)}).catch(e=>{u.add({severity:"error",summary:"Kesalahan",detail:e.message,life:3e3})})},K=d(""),j=d(!1),P=d(null),Q=n=>{P.value=n,C.require({message:"Anda yakin ingin memilih jawaban ini?",header:"Konfirmasi",icon:"pi pi-exclamation-triangle",acceptLabel:"Ya, Pilih",rejectLabel:"Batal",acceptClass:"p-button-success",rejectClass:"p-button-secondary",accept:()=>{j.value=!0},reject:()=>{}})},R=n=>{const e={test_token:c.value.test_token,id_question:r.value.id_question,answer:n,time_taken:x.value,current_question:g.value.current_question,current_level:g.value.current_level,answer_reason:K.value};E().submitAnswer(e).then(i=>{const t=i.data;g.value=t,clearInterval(L.value),x.value=0,L.value=null,K.value="",j.value=!1}).catch(i=>{i.status===404&&(localStorage.removeItem("testToken"),window.location.href="/assessment"),u.add({severity:"error",summary:"Kesalahan",detail:i,life:3e3})})},O=()=>{const n=B.duration(x.value,"seconds");return`${n.hours()>0?n.hours()+" jam ":""}${n.minutes()} menit ${n.seconds()} detik`},D=d(!1),U=d(null),W=n=>{U.value=n,D.value=!0},G=()=>{window.location.href="/assessment"};return J(()=>g.value,async()=>{await T(),N()},{deep:!0}),J(()=>c.value,async()=>{c.value.test_data.test_status==="completed"&&(clearInterval(f.value),_.value="00:00:00")},{deep:!0}),F(async()=>{await T(),H(),document.addEventListener("visibilitychange",()=>{document.hidden&&u.add({severity:"error",summary:"Pelanggaran",detail:"Anda tidak boleh meninggalkan tab ini selama ujian!",life:3e3})}),document.addEventListener("contextmenu",n=>n.preventDefault()),document.addEventListener("keydown",n=>{(n.ctrlKey&&(n.key==="u"||n.key==="U"||n.key==="s"||n.key==="S")||n.key==="F12"||n.ctrlKey&&n.shiftKey&&(n.key==="I"||n.key==="C"||n.key==="J"))&&(n.preventDefault(),u.add({severity:"error",summary:"Pelanggaran",detail:"Tindakan ini tidak diizinkan selama ujian!",life:3e3}))})}),(n,e)=>{const i=ne("fasicon");return o(),a(S,null,[s("div",ue,[c.value.test_data.test_status!=="completed"?(o(),a("div",ce,[s("h3",me,[e[5]||(e[5]=s("span",{style:{"font-size":"12px"}},"Sisa waktu",-1)),e[6]||(e[6]=s("br",null,null,-1)),s("span",pe,w(_.value),1)])])):b("",!0),s("div",ve,[s("div",fe,[c.value.test_data.test_status!=="completed"?(o(),a("div",ye,[s("h1",ge,"Soal "+w(r.value.no),1),r.value.images&&r.value.images.length>0?(o(),a("div",we,[s("span",he,[l(i,{icon:"image"}),e[7]||(e[7]=v(" Soal bergambar"))]),(o(!0),a(S,null,q(r.value.images,(t,m)=>(o(),a("div",{key:m},[s("img",{onClick:V=>W(t),src:`https://api.imanextgencbt.id/usercontent/image/${t.src}`,alt:"Soal Image",style:{cursor:"pointer",width:"450px","border-radius":"10px","margin-bottom":"1rem","box-shadow":"5px 5px 20px rgba(0,0,0,0.1)"}},null,8,be)]))),128)),s("span",ke,[l(i,{icon:"magnifying-glass-plus"}),e[8]||(e[8]=v(" Klik pada gambar untuk memperbesar"))])])):b("",!0),s("div",xe,[(o(!0),a(S,null,q(r.value.soal,(t,m)=>(o(),a("span",{key:m,innerHTML:t,style:{display:"block"}},null,8,_e))),128))]),s("div",Ce,[(o(!0),a(S,null,q(r.value.answers,(t,m)=>(o(),a("button",{onClick:V=>Q(t),class:"question-opt",key:m},[s("span",{innerHTML:t.value,style:{"word-wrap":"break-word"}},null,8,Te)],8,Le))),128))]),l(k(oe)),s("p",Ee,[e[9]||(e[9]=v("Difficulty: ")),s("b",null,"Level "+w(r.value.level),1)]),e[10]||(e[10]=s("p",{style:{margin:"0","font-size":"12px",color:"#555","margin-top":"0.5rem"}},[v(" Pertanyaan tidak dapat diulang. Pastikan untuk memilih jawaban dengan hati-hati."),s("br")],-1)),s("p",Se,[s("i",null,w(O())+" berlalu",1)])])):(o(),a("div",Ie,[e[12]||(e[12]=s("img",{src:"https://i.pinimg.com/originals/91/36/df/9136df0949a40e6567c6f4f7a6343672.gif",style:{width:"200px",height:"200px","object-fit":"cover","border-radius":"200px"}},null,-1)),e[13]||(e[13]=s("h1",{style:{"text-align":"center",margin:"0",padding:"0","margin-top":"1rem"}},"Tes telah selesai",-1)),e[14]||(e[14]=s("p",{style:{"text-align":"center","font-size":"18px","margin-top":"1rem"}},"Terima kasih telah menyelesaikan tes ini.",-1)),l(k(A),{onClick:G},{default:I(()=>[l(i,{icon:"arrow-left"}),e[11]||(e[11]=v(" Kembali"))]),_:1})]))]),s("div",$e,[s("div",ze,[(o(!0),a(S,null,q(y.value,(t,m)=>(o(),a("div",{key:m,class:"soal-item",style:{width:"70px",height:"70px",background:"#ddd","border-radius":"10px",position:"relative"}},[!t.answered&&!t.current?(o(),a("span",Ke,[s("span",je,w(t.no),1)])):b("",!0),!t.answered&&t.current?(o(),a("span",De,[s("span",Me,w(t.no),1)])):b("",!0),t.answered&&!t.current?(o(),a("span",qe,[s("span",Pe,[l(i,{icon:"check"}),v(" "+w(t.no),1)])])):b("",!0),t.answered&&t.current?(o(),a("span",Ve,[s("span",Ae,[l(i,{icon:"check"}),v(" "+w(t.no),1)])])):b("",!0)]))),128))])])])]),D.value?(o(),a("div",Be,[s("button",{class:"img-enl-dismiss",type:"button",onClick:e[0]||(e[0]=t=>D.value=!1)},[l(i,{icon:"close"})]),s("img",{src:`https://api.imanextgencbt.id/usercontent/image/${U.value.src}`,alt:"Enlarged Image",style:{"max-width":"90%","max-height":"90%",width:"60%","border-radius":"10px","box-shadow":"5px 5px 20px rgba(0,0,0,0.1)"}},null,8,Ue),l(k(A),{class:"p-button-secondary",style:{"margin-top":"2rem"},onClick:e[1]||(e[1]=t=>D.value=!1)},{default:I(()=>[s("b",null,[l(i,{icon:"close"}),e[15]||(e[15]=v(" Tutup Gambar"))])]),_:1})])):b("",!0),l(k(ae),{header:"Alasan Jawaban",visible:j.value,"onUpdate:visible":e[4]||(e[4]=t=>j.value=t),style:{width:"40vw"}},{default:I(()=>[s("p",null,[e[16]||(e[16]=v("Mengapa anda memilih:")),e[17]||(e[17]=s("br",null,null,-1)),s("b",null,'"'+w(P.value.value)+'"',1),e[18]||(e[18]=v("?"))]),l(k(le),{variant:"in"},{default:I(()=>[l(k(ie),{modelValue:K.value,"onUpdate:modelValue":e[2]||(e[2]=t=>K.value=t),rows:"5",style:{width:"100%"}},null,8,["modelValue"]),e[19]||(e[19]=s("label",null,"Alasan",-1))]),_:1}),l(k(A),{onClick:e[3]||(e[3]=t=>R(P.value)),style:{"margin-top":"1rem"}},{default:I(()=>[l(i,{icon:"check"}),e[20]||(e[20]=v(" Kirim Jawaban"))]),_:1})]),_:1},8,["visible"])],64)}}}),nt=re(Je,[["__scopeId","data-v-2f5e134b"]]);export{nt as default};
