import{C as G}from"./ContentWrapper-CT3Djl6-.js";import{i as O}from"./index-Bb6yjXMn.js";import{h as H}from"./moment-C5S46NFB.js";import{h as q}from"./html2canvas.esm-BfYXEYrK.js";import{s as U}from"./index-B9FTO_uF.js";import{s as $}from"./index-VUYHbI9n.js";import{e as Y}from"./index-drVR4mfP.js";import{d as z,r as c,Q as V,i as M,c as h,o as p,a as e,F as L,O as T,t as _,b as S,a9 as F,f as W,P as Q,p as K,w as D,k as y,m as X,u as k}from"./index-BQBBGVP6.js";import{t as I}from"./testModel-CHRtJ_eZ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-Bm-U0k4B.js";import"./index-mJqKtfbO.js";import"./index-DCBZFGl8.js";import"./index-DojOM98e.js";import"./index-t--hEgTQ.js";const Z={key:0,style:{display:"flex","flex-flow":"column"}},ee={style:{"margin-bottom":"1.5rem","padding-bottom":"1rem","padding-top":"1rem"}},ae={style:{display:"flex","flex-flow":"row nowrap","justify-content":"center",gap:"1rem"}},te={style:{margin:"0",padding:"5px","font-size":"13px"}},re={style:{"font-size":"12px"}},ne={key:1,style:{display:"flex","flex-flow":"column","justify-content":"center","align-items":"center"}},oe=z({__name:"RadarChart",props:{data:{type:Object,required:!0}},setup(C){const s=C,v=c(null),d=c(null),f=c({tooltip:{},legend:{data:["Jawaban Benar","Jawaban Salah"],left:"center"},color:["#4caf50","#f44336"],radar:{center:["50%","55%"],radius:"55%",indicator:[],shape:"circle",name:{show:!0,textStyle:{fontSize:12,color:"#333",overflow:"break",lineHeight:16}},nameGap:10,splitNumber:5,axisLine:{lineStyle:{color:"#aaa"}},splitLine:{lineStyle:{color:"#aaa"}}},series:[{name:"Jawaban Benar",type:"radar",data:[]},{name:"Jawaban Salah",type:"radar",data:[]}]}),g=()=>new Promise((t,a)=>{try{setTimeout(()=>{v.value&&(d.value=O(v.value),d.value.setOption(f.value),x())},500)}catch(i){a(i)}}),x=()=>{const t=Object.keys(s.data),a=t.map(b=>s.data[b].correct),i=t.map(b=>s.data[b].incorrect),w=Math.max(...a,...i);f.value.radar.indicator=t.map(b=>({name:b,max:w})),f.value.series[0].data=[{name:"Jawaban Benar",value:a,itemStyle:{color:"#4caf50"},lineStyle:{color:"#4caf50"},areaStyle:{color:"rgba(76, 175, 80, 0.3)"}}],f.value.series[1].data=[{name:"Jawaban Salah",value:i,itemStyle:{color:"#f44336"},lineStyle:{color:"#f44336"},areaStyle:{color:"rgba(244, 67, 54, 0.3)"}}],d.value.setOption(f.value)};return V(()=>[s.data],()=>{g().then(()=>{x()}).catch(t=>{console.error("Error initializing radar chart:",t)})},{deep:!0}),M(async()=>{await g()}),(t,a)=>Object.keys(s.data).length>0?(p(),h("div",Z,[e("div",ee,[e("div",{ref_key:"radarChart",ref:v,style:{width:"100%",height:"400px"}},null,512),e("div",ae,[(p(!0),h(L,null,T(s.data,(i,w)=>(p(),h("div",{key:w,style:{"text-align":"center",display:"flex","flex-flow":"column","align-items":"center",border:"1px solid #ccc",padding:"10px"}},[e("h4",te,_(i.indicator_name),1),e("span",re,[a[0]||(a[0]=S("Benar: ")),e("b",null,_(i.correct),1),a[1]||(a[1]=S("   ·   Salah: ")),e("b",null,_(i.incorrect),1)])]))),128))])])])):(p(),h("div",ne,a[2]||(a[2]=[e("img",{style:{filter:"grayscale(1)",opacity:"0.2",width:"250px",height:"250px"},src:"https://thumb.ac-illust.com/90/909be00ebae674a6065df004e1000932_t.jpeg"},null,-1),e("span",{style:{"font-size":"13px","font-weight":"bold"}},"Tidak ada data performa untuk instansi ini",-1)])))}}),le={key:0,style:{display:"flex","flex-flow":"column"}},se={style:{"margin-bottom":"1.5rem","padding-bottom":"1rem","padding-top":"1rem"}},ie={style:{display:"flex","flex-flow":"row wrap","justify-content":"center",gap:"1rem","margin-top":"1rem"}},ce={style:{margin:"0",padding:"5px","font-size":"13px"}},de={style:{"font-size":"12px"}},ue={style:{color:"#4caf50"}},me={style:{color:"#f44336"}},pe={key:1,style:{display:"flex","flex-flow":"column","justify-content":"center","align-items":"center",padding:"2rem"}},fe=z({__name:"RadarChartMateri",props:{data:{type:Object,required:!0}},setup(C){const s=C,v=c(null),d=c(null),f=c({tooltip:{trigger:"item",formatter:function(t){return`${t.seriesName}<br/>${t.name}: ${t.value}`}},legend:{data:["Jawaban Benar","Jawaban Salah"],left:"center",top:20},color:["#4caf50","#f44336"],radar:{center:["50%","55%"],radius:"55%",indicator:[],shape:"circle",name:{show:!0,textStyle:{fontSize:12,color:"#333",overflow:"break",lineHeight:16}},nameGap:15,splitNumber:5,axisLine:{lineStyle:{color:"#aaa"}},splitLine:{lineStyle:{color:"#aaa"}}},series:[{name:"Jawaban Benar",type:"radar",data:[]},{name:"Jawaban Salah",type:"radar",data:[]}]}),g=async()=>{try{await F(),v.value&&!d.value&&(d.value=O(v.value),window.addEventListener("resize",()=>{var t;(t=d.value)==null||t.resize()}))}catch(t){console.error("Error initializing radar chart:",t)}},x=()=>{if(!d.value||!s.data)return;const t=Object.keys(s.data).map(m=>({key:m,...s.data[m]}));if(t.length===0)return;const a=t.map(m=>m.correct||0),i=t.map(m=>m.incorrect||0),w=t.map(m=>m.materi||m.key),b=Math.max(...a,...i,1);f.value.radar.indicator=w.map(m=>({name:m,max:b*1.2})),f.value.series=[{name:"Jawaban Benar",type:"radar",data:[{name:"Jawaban Benar",value:a,itemStyle:{color:"#4caf50"},lineStyle:{color:"#4caf50",width:2},areaStyle:{color:"rgba(76, 175, 80, 0.3)"}}]},{name:"Jawaban Salah",type:"radar",data:[{name:"Jawaban Salah",value:i,itemStyle:{color:"#f44336"},lineStyle:{color:"#f44336",width:2},areaStyle:{color:"rgba(244, 67, 54, 0.3)"}}]}],d.value.setOption(f.value,!0)};return V(()=>s.data,async()=>{d.value||await g(),x()},{deep:!0,immediate:!0}),M(async()=>{await g(),x()}),(t,a)=>Object.keys(s.data).length>0?(p(),h("div",le,[e("div",se,[e("div",{ref_key:"radarChart",ref:v,style:{width:"100%",height:"400px"}},null,512),e("div",ie,[(p(!0),h(L,null,T(s.data,(i,w)=>(p(),h("div",{key:w,style:{"text-align":"center",display:"flex","flex-flow":"column","align-items":"center",border:"1px solid #ccc",padding:"10px","border-radius":"4px","min-width":"150px"}},[e("h4",ce,_(i.materi||w),1),e("span",de,[e("span",ue,[a[0]||(a[0]=S("Benar: ")),e("b",null,_(i.correct||0),1)]),a[2]||(a[2]=S("   ·   ")),e("span",me,[a[1]||(a[1]=S("Salah: ")),e("b",null,_(i.incorrect||0),1)])])]))),128))])])])):(p(),h("div",pe,a[3]||(a[3]=[e("img",{style:{filter:"grayscale(1)",opacity:"0.2",width:"250px",height:"250px"},src:"https://thumb.ac-illust.com/90/909be00ebae674a6065df004e1000932_t.jpeg"},null,-1),e("span",{style:{"font-size":"13px","font-weight":"bold","margin-top":"1rem"}},"Tidak ada data performa untuk instansi ini",-1)])))}}),ye={style:{"text-align":"center",margin:"0","margin-bottom":"1rem"}},he={style:{display:"flex","flex-flow":"row nowrap","align-items":"center","justify-content":"center"}},ve={key:0,style:{"margin-top":"1rem"}},ge={style:{"text-align":"center",margin:"0","margin-bottom":"1rem"}},we={style:{display:"flex","flex-flow":"row wrap","justify-content":"space-between",gap:"1rem"}},xe=["id"],be={style:{"text-align":"center",margin:"0","margin-bottom":"0.3rem"}},_e={style:{"text-align":"center","font-size":"12px"}},Se={style:{display:"flex","flex-flow":"row nowrap","justify-content":"center","margin-top":"1rem"}},ke={key:1,style:{"margin-top":"1rem",display:"flex","flex-flow":"column","justify-content":"center","align-items":"center"}},Ee=z({__name:"LaporanGrafik",setup(C){const s=c(null),v=c(null),d=c({title:{text:"Akumulasi Jawaban",left:"center",top:10,textStyle:{fontSize:18,fontWeight:"bold"}},tooltip:{},legend:{data:["Jawaban Benar","Jawaban Salah"],top:40,left:"center"},radar:{center:["50%","55%"],radius:"55%",indicator:[],shape:"circle",name:{show:!0,textStyle:{fontSize:12,color:"#333",overflow:"break",lineHeight:16}},nameGap:10,splitNumber:5,axisLine:{lineStyle:{color:"#aaa"}},splitLine:{lineStyle:{color:"#aaa"}}},series:[{name:"Jawaban Benar",type:"radar",data:[]},{name:"Jawaban Salah",type:"radar",data:[]}]}),f=I(),g=W();Q(),c([]);const x=c([]),t=c([]),a=c(null),i=()=>new Promise((o,r)=>{w(),I().getSessions().then(u=>{const l=u.map(n=>({id:n._id,name:n.name,instances:n.instances,questions:n.questions,isStarted:n.isStarted}));x.value=l,t.value=l.map(n=>({label:n.name,value:n.id})),a.value=t.value[0].value,o(l)}).catch(u=>{r(u)})}),w=()=>{x.value=[],t.value=[],a.value=null},b=()=>new Promise((o,r)=>{const u={id_test:a.value};f.getTestReports(u).then(l=>{o(l)}).catch(l=>{g.add({severity:"error",summary:"Oops",detail:l,life:3e3}),r(l)})}),m=c([]),E=()=>{f.getMateriReport({id_test:a.value}).then(o=>{m.value=o.score}).catch(o=>{g.add({severity:"error",summary:"Oops",detail:o,life:3e3})})},P=c([]),B=c([]),J=c([]),R=()=>{b().then(async o=>{console.log(o);const r=Object.keys(o.result),u=r.map(n=>Math.max(o.result[n].correct,o.result[n].incorrect)),l=Math.max(...u);B.value=r.map(n=>({name:n,max:l})),J.value=r.map(n=>o.result[n].correct),await N(),d.value.radar.indicator=B.value,d.value.series[0].data=[{value:J.value,name:"Jawaban Benar"}],d.value.series[1].data=[{value:r.map(n=>o.result[n].incorrect),name:"Jawaban Salah"}],v.value.setOption(d.value),P.value=o.instanceResults}).catch(o=>{J.value=[],B.value=[]})},N=()=>new Promise((o,r)=>{try{setTimeout(()=>{s.value&&(v.value=O(s.value),v.value.setOption(d.value),o(!0))},500)}catch(u){r(u)}}),A=(o,r)=>{const u=document.getElementById(o);if(!u){g.add({severity:"error",summary:"Error",detail:"Area not found",life:3e3});return}q(u,{scale:6}).then(l=>{const n=r.instance_data.name.replace(/\s+/g,"_").toLowerCase()+"_"+H().format("YYYYMMDD_HHmmss"),j=document.createElement("a");j.href=l.toDataURL("image/jpeg"),j.download=`${n}.png`,j.click(),g.add({severity:"success",summary:"Success",detail:"Capture downloaded",life:3e3})}).catch(l=>{g.add({severity:"error",summary:"Error",detail:l.message,life:3e3})})};return M(async()=>{await i(),R(),E()}),(o,r)=>{const u=X("fasicon");return p(),K(G,{"content-title":"Laporan Grafik"},{default:D(()=>[e("h2",ye,[y(u,{icon:"chart-line"}),r[1]||(r[1]=S(" Performa: Sesi"))]),y(k($)),e("div",he,[y(k(Y),{onChange:R,modelValue:a.value,"onUpdate:modelValue":r[0]||(r[0]=l=>a.value=l),options:t.value,"option-label":"label","option-value":"value",placeholder:"Pilih Test",class:"w-full md:w-14rem"},null,8,["modelValue","options"])]),J.value.length>0?(p(),h("div",ve,[e("div",{ref_key:"radarChart",ref:s,style:{width:"100%",height:"400px"}},null,512),e("h2",ge,[y(u,{icon:"chart-line"}),r[2]||(r[2]=S(" Performa: Instansi"))]),y(k($)),e("div",we,[(p(!0),h(L,null,T(P.value,(l,n)=>(p(),h("div",{key:n,style:{width:"49%"}},[e("div",{style:{display:"flex","flex-flow":"column"},id:`captureArea-${n}`},[e("h3",be,[e("b",null,_(l.instance_data.name),1)]),y(k($)),e("span",_e,[e("b",null,_(l.participants.length)+" Partisipan",1)]),y(oe,{data:l.data},null,8,["data"])],8,xe),y(k($)),e("div",Se,[y(k(U),{style:{"font-size":"12px"},onClick:j=>A(`captureArea-${n}`,l),class:"mt-2"},{default:D(()=>[y(u,{icon:"download"}),r[3]||(r[3]=S(" Unduh Data"))]),_:2},1032,["onClick"])])]))),128))]),y(k($)),y(fe,{data:m.value},null,8,["data"])])):(p(),h("div",ke,r[4]||(r[4]=[e("img",{style:{width:"250px",height:"250px","object-fit":"contain"},src:"https://assets-v2.lottiefiles.com/a/f0470cd6-117f-11ee-a4ed-1b2d7fb6aaaf/i83iUdPISg.gif"},null,-1),e("h3",{style:{"text-align":"center",margin:"0"}},"Belum ada yang tersedia data untuk ditampilkan pada sesi ini",-1)])))]),_:1})}}});export{Ee as default};
