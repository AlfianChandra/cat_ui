/* empty css                  */import{d as W}from"./jwt-DHQMwwia.js";import{t as T}from"./testSessionModel-BJ13N31X.js";import{i as V,U as G,d as Y,r as m,f as X,Q as Z,S as A,c as o,a as n,l as _,t as g,k as v,b as h,m as ee,F as E,O as j,u as D,w as B,o as a}from"./index-BB40m8p3.js";import{s as P}from"./index-DgklKSqE.js";import{s as te}from"./index-ISUdHp_3.js";import{h as M}from"./moment-C5S46NFB.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-t--hEgTQ.js";const ne=(w,k={})=>{const{maxIdleTime:L=30}=k;let l=null;const f=()=>{l&&clearTimeout(l),l=setTimeout(()=>{w("Idle too long (possibly cheating)")},L*1e3)},p=()=>{document.hidden&&w("User switched tab or minimized the window")},b=c=>{c.preventDefault(),w("Right click is disabled")},u=c=>{const C=["F12","Control+Shift+I","Control+Shift+J","Control+U","Meta+Option+I"],I=[c.ctrlKey?"Control":"",c.metaKey?"Meta":"",c.shiftKey?"Shift":"",c.altKey?"Alt":"",c.key].filter(Boolean).join("+");(C.includes(I)||C.includes(c.key))&&(c.preventDefault(),w(`Blocked key combo detected: ${I}`))},x=c=>{c.preventDefault(),w("Copy/Paste action blocked")},S=()=>{w("Window resized — Possible multi-monitor cheating")},y=()=>{window.addEventListener("blur",p),document.addEventListener("visibilitychange",p),document.addEventListener("contextmenu",b),document.addEventListener("keydown",u),document.addEventListener("copy",x),document.addEventListener("paste",x),window.addEventListener("resize",S),window.addEventListener("mousemove",f),window.addEventListener("keypress",f),f()},r=()=>{window.removeEventListener("blur",p),document.removeEventListener("visibilitychange",p),document.removeEventListener("contextmenu",b),document.removeEventListener("keydown",u),document.removeEventListener("copy",x),document.removeEventListener("paste",x),window.removeEventListener("resize",S),window.removeEventListener("mousemove",f),window.removeEventListener("keypress",f),clearTimeout(l)};V(y),G(r)},oe={class:"main-layer"},ae={key:0,class:"ly-flex-col"},ie={style:{"text-align":"center",margin:"0",padding:"0"}},le={style:{"font-size":"24px"}},re={class:"ly-flex-row",style:{"margin-top":"1rem",gap:"0.5rem"}},de={class:"ly-col",style:{width:"70%","box-sizing":"border-box",border:"1px solid #ccc",padding:"20px","border-radius":"10px",position:"relative"}},ce={key:0},ue={style:{margin:"0","margin-bottom":"1rem"}},me={key:0,style:{"margin-bottom":"1rem",border:"1px solid #ccc",padding:"20px","border-radius":"10px",display:"flex","flex-flow":"column","justify-content":"center","align-items":"center"}},pe={style:{"margin-bottom":"1rem"}},ve=["onClick","src"],fe={style:{"font-size":"11px"}},ye={style:{display:"block",width:"100%"}},ge=["innerHTML"],he={style:{display:"flex","flex-flow":"column","margin-top":"1rem"}},we=["onClick"],_e=["innerHTML"],ke={style:{margin:"0"}},be={style:{margin:"0","margin-top":"0.5rem","font-size":"10px",color:"#888"}},xe={key:1,style:{display:"flex","flex-flow":"column","justify-content":"center","align-items":"center",position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}},Le={class:"ly-col",style:{width:"30%","box-sizing":"border-box",border:"1px solid #ccc",padding:"20px","border-radius":"10px"}},Ce={class:"soal-map",style:{width:"100%",display:"flex","flex-flow":"row wrap","justify-content":"space-around",gap:"1rem",position:"relative"}},Te={key:0,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",display:"flex","flex-flow":"row nowrap","align-items":"center","justify-content":"center"}},Ee={style:{"font-size":"13px"}},Se={key:1,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",display:"flex","flex-flow":"row nowrap","align-items":"center","justify-content":"center",background:"#f44336",color:"#fff","border-radius":"10px"}},Ie={style:{"font-size":"13px"}},ze={key:2,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",display:"flex","flex-flow":"row nowrap","align-items":"center","justify-content":"center",background:"#4caf50",color:"#fff","border-radius":"10px"}},Ke={style:{"font-size":"13px"}},je={key:3,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",display:"flex","flex-flow":"row nowrap","align-items":"center","justify-content":"center",background:"#2196f3",color:"#fff","border-radius":"10px"}},$e={style:{"font-size":"13px"}},De={key:0,class:"img-enl"},Me=["src"],qe=Y({__name:"ClientAssessmentSession",setup(w){const k=m(0),L=m(null),l=m({}),f=m([]),p=m(null),b=m(""),u=X(),x=Z(),S=m(localStorage.getItem("authToken")||""),y=m({current_question:1,current_level:1}),r=m({id_user:W(S.value).id,test_token:localStorage.getItem("testToken")||"",test_data:{}});ne(s=>{u.add({severity:"error",summary:"🚨 Cheating Attempt Detected!",detail:s,life:3e3}),console.log("Cheat Attempt:",s)},{maxIdleTime:60});const C=()=>new Promise((s,e)=>{const i=r.value;T().getSessionData(i).then(t=>{r.value.test_data=t,p.value&&clearInterval(p.value),p.value=setInterval(()=>{const d=new Date,$=M(r.value.test_data.end_time),K=M.duration($.diff(d));b.value=`0${K.hours()}:${K.minutes()}:${K.seconds()}`.replace(/:0(\d)/,":$1"),K.asSeconds()<=0&&(clearInterval(p.value),T().setAsCompleted({test_token:r.value.test_token}).then(()=>{u.add({severity:"success",summary:"Selesai",detail:"Tes telah selesai.",life:3e3}),window.location.href="/assessment/session"}).catch(R=>{u.add({severity:"error",summary:"Kesalahan",detail:R.message,life:3e3})}))},500),f.value=t.question_map.map(d=>({no:d.no,answered:d.answered,current:!1})),s(null)}).catch(t=>{t.status===404&&(localStorage.removeItem("testToken"),window.location.href="/assessment"),t.state!=null||t.state==="not_started"?(u.add({severity:"error",summary:"Kesalahan",detail:t.message,life:3e3}),window.location.href="/assessment"):u.add({severity:"error",summary:"Kesalahan",detail:t.message,life:3e3}),e(t)})}),I=()=>{const s={test_token:r.value.test_token};T().getCurrentState(s).then(e=>{y.value=e}).catch(e=>{e.status===404&&(localStorage.removeItem("testToken"),window.location.href="/assessment"),u.add({severity:"error",summary:"Kesalahan",detail:e,life:3e3})})},U=()=>{I()},F=()=>{const s={test_token:r.value.test_token,current_question:y.value.current_question,current_level:y.value.current_level};T().getQuestion(s).then(e=>{const i=e.no;l.value=e,f.value.forEach(t=>{t.no===i?t.current=!0:t.current=!1}),L.value=setInterval(()=>{k.value+=1},1e3)}).catch(e=>{u.add({severity:"error",summary:"Kesalahan",detail:e.message,life:3e3})})},H=s=>{x.require({message:"Anda yakin ingin memilih jawaban ini?",header:"Konfirmasi",icon:"pi pi-exclamation-triangle",acceptLabel:"Ya, Pilih",rejectLabel:"Batal",acceptClass:"p-button-success",rejectClass:"p-button-secondary",accept:()=>{J(s)},reject:()=>{}})},J=s=>{const e={test_token:r.value.test_token,id_question:l.value.id_question,answer:s,time_taken:k.value,current_question:y.value.current_question,current_level:y.value.current_level};T().submitAnswer(e).then(i=>{const t=i.data;y.value=t,clearInterval(L.value),k.value=0,L.value=null}).catch(i=>{i.status===404&&(localStorage.removeItem("testToken"),window.location.href="/assessment"),u.add({severity:"error",summary:"Kesalahan",detail:i,life:3e3})})},N=()=>{const s=M.duration(k.value,"seconds");return`${s.hours()>0?s.hours()+" jam ":""}${s.minutes()} menit ${s.seconds()} detik`},z=m(!1),q=m(null),Q=s=>{q.value=s,z.value=!0},O=()=>{window.location.href="/assessment"};return A(()=>y.value,async()=>{await C(),F()},{deep:!0}),A(()=>r.value,async()=>{r.value.test_data.test_status==="completed"&&(clearInterval(p.value),b.value="00:00:00")},{deep:!0}),V(async()=>{await C(),U(),document.addEventListener("visibilitychange",()=>{document.hidden&&alert("❌ Anda tidak boleh meninggalkan tab ini selama ujian!")}),document.addEventListener("contextmenu",s=>s.preventDefault()),document.addEventListener("keydown",s=>{(s.ctrlKey&&(s.key==="u"||s.key==="U"||s.key==="s"||s.key==="S")||s.key==="F12"||s.ctrlKey&&s.shiftKey&&(s.key==="I"||s.key==="C"||s.key==="J"))&&(s.preventDefault(),alert("🚫 Akses dilarang bro! Jangan coba buka inspect!"))})}),(s,e)=>{const i=ee("fasicon");return a(),o(E,null,[n("div",oe,[r.value.test_data.test_status!=="completed"?(a(),o("div",ae,[n("h3",ie,[e[2]||(e[2]=n("span",{style:{"font-size":"12px"}},"Sisa waktu",-1)),e[3]||(e[3]=n("br",null,null,-1)),n("span",le,g(b.value),1)])])):_("",!0),n("div",re,[n("div",de,[r.value.test_data.test_status!=="completed"?(a(),o("div",ce,[n("h1",ue,"Soal "+g(l.value.no),1),l.value.images&&l.value.images.length>0?(a(),o("div",me,[n("span",pe,[v(i,{icon:"image"}),e[4]||(e[4]=h(" Soal bergambar"))]),(a(!0),o(E,null,j(l.value.images,(t,d)=>(a(),o("div",{key:d},[n("img",{onClick:$=>Q(t),src:`http://localhost:2512/usercontent/image/${t.src}`,alt:"Soal Image",style:{cursor:"pointer",width:"450px","border-radius":"10px","margin-bottom":"1rem","box-shadow":"5px 5px 20px rgba(0,0,0,0.1)"}},null,8,ve)]))),128)),n("span",fe,[v(i,{icon:"magnifying-glass-plus"}),e[5]||(e[5]=h(" Klik pada gambar untuk memperbesar"))])])):_("",!0),n("div",ye,[(a(!0),o(E,null,j(l.value.soal,(t,d)=>(a(),o("span",{key:d,innerHTML:t,style:{display:"block"}},null,8,ge))),128))]),n("div",he,[(a(!0),o(E,null,j(l.value.answers,(t,d)=>(a(),o("button",{onClick:$=>H(t),class:"question-opt",key:d},[n("span",{innerHTML:t.value,style:{"word-wrap":"break-word"}},null,8,_e)],8,we))),128))]),v(D(te)),n("p",ke,[e[6]||(e[6]=h("Difficulty: ")),n("b",null,"Level "+g(l.value.level),1)]),e[7]||(e[7]=n("p",{style:{margin:"0","font-size":"12px",color:"#555","margin-top":"0.5rem"}},[h(" Pertanyaan tidak dapat diulang. Pastikan untuk memilih jawaban dengan hati-hati."),n("br")],-1)),n("p",be,[n("i",null,g(N())+" berlalu",1)])])):(a(),o("div",xe,[e[9]||(e[9]=n("img",{src:"https://i.pinimg.com/originals/91/36/df/9136df0949a40e6567c6f4f7a6343672.gif",style:{width:"200px",height:"200px","object-fit":"cover","border-radius":"200px"}},null,-1)),e[10]||(e[10]=n("h1",{style:{"text-align":"center",margin:"0",padding:"0","margin-top":"1rem"}},"Tes telah selesai",-1)),e[11]||(e[11]=n("p",{style:{"text-align":"center","font-size":"18px","margin-top":"1rem"}},"Terima kasih telah menyelesaikan tes ini.",-1)),v(D(P),{onClick:O},{default:B(()=>[v(i,{icon:"arrow-left"}),e[8]||(e[8]=h(" Kembali"))]),_:1})]))]),n("div",Le,[n("div",Ce,[(a(!0),o(E,null,j(f.value,(t,d)=>(a(),o("div",{key:d,class:"soal-item",style:{width:"70px",height:"70px",background:"#ddd","border-radius":"10px",position:"relative"}},[!t.answered&&!t.current?(a(),o("span",Te,[n("span",Ee,g(t.no),1)])):_("",!0),!t.answered&&t.current?(a(),o("span",Se,[n("span",Ie,g(t.no),1)])):_("",!0),t.answered&&!t.current?(a(),o("span",ze,[n("span",Ke,[v(i,{icon:"check"}),h(" "+g(t.no),1)])])):_("",!0),t.answered&&t.current?(a(),o("span",je,[n("span",$e,[v(i,{icon:"check"}),h(" "+g(t.no),1)])])):_("",!0)]))),128))])])])]),z.value?(a(),o("div",De,[n("button",{class:"img-enl-dismiss",type:"button",onClick:e[0]||(e[0]=t=>z.value=!1)},[v(i,{icon:"close"})]),n("img",{src:`http://localhost:2512/usercontent/image/${q.value.src}`,alt:"Enlarged Image",style:{"max-width":"90%","max-height":"90%",width:"60%","border-radius":"10px","box-shadow":"5px 5px 20px rgba(0,0,0,0.1)"}},null,8,Me),v(D(P),{class:"p-button-secondary",style:{"margin-top":"2rem"},onClick:e[1]||(e[1]=t=>z.value=!1)},{default:B(()=>[n("b",null,[v(i,{icon:"close"}),e[12]||(e[12]=h(" Tutup Gambar"))])]),_:1})])):_("",!0)],64)}}}),Qe=se(qe,[["__scopeId","data-v-cf6b85f6"]]);export{Qe as default};
