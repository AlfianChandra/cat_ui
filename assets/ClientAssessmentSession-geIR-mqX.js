/* empty css                  */import{d as X}from"./jwt-DHQMwwia.js";import{t as E}from"./testSessionModel-BoyBipDW.js";import{b as J,U as Z,g as ee,r as d,i as te,j as se,q as U,c as a,a as s,H as b,k as l,t as w,n as p,p as ne,F as I,I as q,l as k,w as S,o}from"./index-DfPGng49.js";import{s as A}from"./index--RL2ZOfW.js";import{s as ae}from"./index-9uu7ZcRe.js";import{s as oe}from"./index-9sMdTFS6.js";import{h as B}from"./moment-C5S46NFB.js";import{s as ie}from"./index-DiYk_rO4.js";import{s as le}from"./index-mdnLpn9f.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-t--hEgTQ.js";import"./index-DxDiYVdC.js";import"./index-BNEW3akE.js";const de=(h,x={})=>{const{maxIdleTime:T=30}=x;let r=null;const y=()=>{r&&clearTimeout(r),r=setTimeout(()=>{h("Idle too long (possibly cheating)")},T*1e3)},f=()=>{document.hidden&&h("User switched tab or minimized the window")},_=v=>{v.preventDefault(),h("Right click is disabled")},u=v=>{const C=["F12","Control+Shift+I","Control+Shift+J","Control+U","Meta+Option+I"],j=[v.ctrlKey?"Control":"",v.metaKey?"Meta":"",v.shiftKey?"Shift":"",v.altKey?"Alt":"",v.key].filter(Boolean).join("+");(C.includes(j)||C.includes(v.key))&&(v.preventDefault(),h(`Blocked key combo detected: ${j}`))},L=v=>{v.preventDefault(),h("Copy/Paste action blocked")},$=()=>{h("Window resized â€” Possible multi-monitor cheating")},g=()=>{window.addEventListener("blur",f),document.addEventListener("visibilitychange",f),document.addEventListener("contextmenu",_),document.addEventListener("keydown",u),document.addEventListener("copy",L),document.addEventListener("paste",L),window.addEventListener("resize",$),window.addEventListener("mousemove",y),window.addEventListener("keypress",y),y()},c=()=>{window.removeEventListener("blur",f),document.removeEventListener("visibilitychange",f),document.removeEventListener("contextmenu",_),document.removeEventListener("keydown",u),document.removeEventListener("copy",L),document.removeEventListener("paste",L),window.removeEventListener("resize",$),window.removeEventListener("mousemove",y),window.removeEventListener("keypress",y),clearTimeout(r)};J(g),Z(c)},ue={class:"main-layer"},ce={key:0,class:"ly-flex-col"},me={style:{"text-align":"center",margin:"0",padding:"0"}},pe={style:{"font-size":"24px"}},ve={class:"ly-flex-row",style:{"margin-top":"1rem",gap:"0.5rem"}},fe={class:"ly-col",style:{width:"70%","box-sizing":"border-box",border:"1px solid #ccc",padding:"20px","border-radius":"10px",position:"relative"}},ye={key:0},ge={style:{margin:"0","margin-bottom":"1rem"}},we={key:0,style:{"margin-bottom":"1rem",border:"1px solid #ccc",padding:"20px","border-radius":"10px",display:"flex","flex-flow":"column","justify-content":"center","align-items":"center"}},he={style:{"margin-bottom":"1rem"}},be=["onClick","src"],ke={style:{"font-size":"11px"}},xe={style:{display:"block",width:"100%"}},_e=["innerHTML"],Le={style:{display:"flex","flex-flow":"column","margin-top":"1rem"}},Te=["onClick"],Ce=["innerHTML"],Ee={style:{margin:"0"}},Ie={style:{margin:"0","margin-top":"0.5rem","font-size":"10px",color:"#888"}},Se={key:1,style:{display:"flex","flex-flow":"column","justify-content":"center","align-items":"center",position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}},$e={class:"ly-col",style:{width:"30%","box-sizing":"border-box",border:"1px solid #ccc",padding:"20px","border-radius":"10px"}},je={class:"soal-map",style:{width:"100%",display:"flex","flex-flow":"row wrap","justify-content":"space-around",gap:"1rem",position:"relative"}},ze={key:0,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",display:"flex","flex-flow":"row nowrap","align-items":"center","justify-content":"center"}},Ke={style:{"font-size":"13px"}},De={key:1,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",display:"flex","flex-flow":"row nowrap","align-items":"center","justify-content":"center",background:"#f44336",color:"#fff","border-radius":"10px"}},Me={style:{"font-size":"13px"}},qe={key:2,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",display:"flex","flex-flow":"row nowrap","align-items":"center","justify-content":"center",background:"#4caf50",color:"#fff","border-radius":"10px"}},Ve={style:{"font-size":"13px"}},Pe={key:3,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",display:"flex","flex-flow":"row nowrap","align-items":"center","justify-content":"center",background:"#2196f3",color:"#fff","border-radius":"10px"}},Ae={style:{"font-size":"13px"}},Be={key:0,class:"img-enl"},He=["src"],Ue=["innerHTML"],Je=ee({__name:"ClientAssessmentSession",setup(h){const x=d(0),T=d(null),r=d({}),y=d([]),f=d(null),_=d(""),u=te(),L=se(),$=d(localStorage.getItem("authToken")||""),g=d({current_question:1,current_level:1}),c=d({id_user:X($.value).id,test_token:localStorage.getItem("testToken")||"",test_data:{}});de(n=>{u.add({severity:"error",summary:"ðŸš¨ Cheating Attempt Detected!",detail:n,life:3e3}),console.log("Cheat Attempt:",n)},{maxIdleTime:60});const C=()=>new Promise((n,e)=>{const i=c.value;E().getSessionData(i).then(t=>{c.value.test_data=t,f.value&&clearInterval(f.value),f.value=setInterval(()=>{const m=new Date,P=B(c.value.test_data.end_time),M=B.duration(P.diff(m));_.value=`0${M.hours()}:${M.minutes()}:${M.seconds()}`.replace(/:0(\d)/,":$1"),M.asSeconds()<=0&&(clearInterval(f.value),E().setAsCompleted({test_token:c.value.test_token}).then(()=>{u.add({severity:"success",summary:"Selesai",detail:"Tes telah selesai.",life:3e3}),window.location.href="/assessment/session"}).catch(Y=>{u.add({severity:"error",summary:"Kesalahan",detail:Y.message,life:3e3})}))},500),y.value=t.question_map.map(m=>({no:m.no,answered:m.answered,current:!1})),n(null)}).catch(t=>{t.status===404&&(localStorage.removeItem("testToken"),window.location.href="/assessment"),t.state!=null||t.state==="not_started"?(u.add({severity:"error",summary:"Kesalahan",detail:t.message,life:3e3}),window.location.href="/assessment"):u.add({severity:"error",summary:"Kesalahan",detail:t.message,life:3e3}),e(t)})}),j=()=>{const n={test_token:c.value.test_token};E().getCurrentState(n).then(e=>{g.value=e}).catch(e=>{e.status===404&&(localStorage.removeItem("testToken"),window.location.href="/assessment"),u.add({severity:"error",summary:"Kesalahan",detail:e,life:3e3})})},F=()=>{j()},N=()=>{const n={test_token:c.value.test_token,current_question:g.value.current_question,current_level:g.value.current_level};E().getQuestion(n).then(e=>{const i=e.no;r.value=e,y.value.forEach(t=>{t.no===i?t.current=!0:t.current=!1}),T.value=setInterval(()=>{x.value+=1},1e3)}).catch(e=>{u.add({severity:"error",summary:"Kesalahan",detail:e.message,life:3e3})})},z=d(""),K=d(!1),V=d(null),R=n=>{V.value=n,L.require({message:"Anda yakin ingin memilih jawaban ini?",header:"Konfirmasi",icon:"pi pi-exclamation-triangle",acceptLabel:"Ya, Pilih",rejectLabel:"Batal",acceptClass:"p-button-success",rejectClass:"p-button-secondary",accept:()=>{K.value=!0},reject:()=>{}})},Q=n=>{const e={test_token:c.value.test_token,id_question:r.value.id_question,answer:n,time_taken:x.value,current_question:g.value.current_question,current_level:g.value.current_level,answer_reason:z.value};E().submitAnswer(e).then(i=>{const t=i.data;g.value=t,clearInterval(T.value),x.value=0,T.value=null,z.value="",K.value=!1}).catch(i=>{i.status===404&&(localStorage.removeItem("testToken"),window.location.href="/assessment"),u.add({severity:"error",summary:"Kesalahan",detail:i,life:3e3})})},O=()=>{const n=B.duration(x.value,"seconds");return`${n.hours()>0?n.hours()+" jam ":""}${n.minutes()} menit ${n.seconds()} detik`},D=d(!1),H=d(null),W=n=>{H.value=n,D.value=!0},G=()=>{window.location.href="/assessment"};return U(()=>g.value,async()=>{await C(),N()},{deep:!0}),U(()=>c.value,async()=>{c.value.test_data.test_status==="completed"&&(clearInterval(f.value),_.value="00:00:00")},{deep:!0}),J(async()=>{await C(),F(),document.addEventListener("visibilitychange",()=>{document.hidden&&u.add({severity:"error",summary:"Pelanggaran",detail:"Anda tidak boleh meninggalkan tab ini selama ujian!",life:3e3})}),document.addEventListener("contextmenu",n=>n.preventDefault()),document.addEventListener("keydown",n=>{(n.ctrlKey&&(n.key==="u"||n.key==="U"||n.key==="s"||n.key==="S")||n.key==="F12"||n.ctrlKey&&n.shiftKey&&(n.key==="I"||n.key==="C"||n.key==="J"))&&(n.preventDefault(),u.add({severity:"error",summary:"Pelanggaran",detail:"Tindakan ini tidak diizinkan selama ujian!",life:3e3}))})}),(n,e)=>{const i=ne("fasicon");return o(),a(I,null,[s("div",ue,[c.value.test_data.test_status!=="completed"?(o(),a("div",ce,[s("h3",me,[e[5]||(e[5]=s("span",{style:{"font-size":"12px"}},"Sisa waktu",-1)),e[6]||(e[6]=s("br",null,null,-1)),s("span",pe,w(_.value),1)])])):b("",!0),s("div",ve,[s("div",fe,[c.value.test_data.test_status!=="completed"?(o(),a("div",ye,[s("h1",ge,"Soal "+w(r.value.no),1),r.value.images&&r.value.images.length>0?(o(),a("div",we,[s("span",he,[l(i,{icon:"image"}),e[7]||(e[7]=p(" Soal bergambar"))]),(o(!0),a(I,null,q(r.value.images,(t,m)=>(o(),a("div",{key:m},[s("img",{onClick:P=>W(t),src:`https://api.imanextgencbt.id/usercontent/image/${t.src}`,alt:"Soal Image",style:{cursor:"pointer",width:"450px","border-radius":"10px","margin-bottom":"1rem","box-shadow":"5px 5px 20px rgba(0,0,0,0.1)"}},null,8,be)]))),128)),s("span",ke,[l(i,{icon:"magnifying-glass-plus"}),e[8]||(e[8]=p(" Klik pada gambar untuk memperbesar"))])])):b("",!0),s("div",xe,[(o(!0),a(I,null,q(r.value.soal,(t,m)=>(o(),a("span",{key:m,innerHTML:t,style:{display:"block"}},null,8,_e))),128))]),s("div",Le,[(o(!0),a(I,null,q(r.value.answers,(t,m)=>(o(),a("button",{onClick:P=>R(t),class:"question-opt",key:m},[s("span",{innerHTML:t.value,style:{"word-wrap":"break-word"}},null,8,Ce)],8,Te))),128))]),l(k(oe)),s("p",Ee,[e[9]||(e[9]=p("Difficulty: ")),s("b",null,"Level "+w(r.value.level),1)]),e[10]||(e[10]=s("p",{style:{margin:"0","font-size":"12px",color:"#555","margin-top":"0.5rem"}},[p(" Pertanyaan tidak dapat diulang. Pastikan untuk memilih jawaban dengan hati-hati."),s("br")],-1)),s("p",Ie,[s("i",null,w(O())+" berlalu",1)])])):(o(),a("div",Se,[e[12]||(e[12]=s("img",{src:"https://i.pinimg.com/originals/91/36/df/9136df0949a40e6567c6f4f7a6343672.gif",style:{width:"200px",height:"200px","object-fit":"cover","border-radius":"200px"}},null,-1)),e[13]||(e[13]=s("h1",{style:{"text-align":"center",margin:"0",padding:"0","margin-top":"1rem"}},"Tes telah selesai",-1)),e[14]||(e[14]=s("p",{style:{"text-align":"center","font-size":"18px","margin-top":"1rem"}},"Terima kasih telah menyelesaikan tes ini.",-1)),l(k(A),{onClick:G},{default:S(()=>[l(i,{icon:"arrow-left"}),e[11]||(e[11]=p(" Kembali"))]),_:1})]))]),s("div",$e,[s("div",je,[(o(!0),a(I,null,q(y.value,(t,m)=>(o(),a("div",{key:m,class:"soal-item",style:{width:"70px",height:"70px",background:"#ddd","border-radius":"10px",position:"relative"}},[!t.answered&&!t.current?(o(),a("span",ze,[s("span",Ke,w(t.no),1)])):b("",!0),!t.answered&&t.current?(o(),a("span",De,[s("span",Me,w(t.no),1)])):b("",!0),t.answered&&!t.current?(o(),a("span",qe,[s("span",Ve,[l(i,{icon:"check"}),p(" "+w(t.no),1)])])):b("",!0),t.answered&&t.current?(o(),a("span",Pe,[s("span",Ae,[l(i,{icon:"check"}),p(" "+w(t.no),1)])])):b("",!0)]))),128))])])])]),D.value?(o(),a("div",Be,[s("button",{class:"img-enl-dismiss",type:"button",onClick:e[0]||(e[0]=t=>D.value=!1)},[l(i,{icon:"close"})]),s("img",{src:`https://api.imanextgencbt.id/usercontent/image/${H.value.src}`,alt:"Enlarged Image",style:{"max-width":"90%","max-height":"90%",width:"60%","border-radius":"10px","box-shadow":"5px 5px 20px rgba(0,0,0,0.1)"}},null,8,He),l(k(A),{class:"p-button-secondary",style:{"margin-top":"2rem"},onClick:e[1]||(e[1]=t=>D.value=!1)},{default:S(()=>[s("b",null,[l(i,{icon:"close"}),e[15]||(e[15]=p(" Tutup Gambar"))])]),_:1})])):b("",!0),l(k(ae),{header:"Alasan Jawaban",visible:K.value,"onUpdate:visible":e[4]||(e[4]=t=>K.value=t),style:{width:"40vw"}},{default:S(()=>[s("p",null,[e[18]||(e[18]=p("Mengapa anda memilih:")),e[19]||(e[19]=s("br",null,null,-1)),s("b",null,[e[16]||(e[16]=p('"')),s("span",{innerHTML:V.value.value},null,8,Ue),e[17]||(e[17]=p('"'))]),e[20]||(e[20]=p("?"))]),l(k(le),{variant:"in"},{default:S(()=>[l(k(ie),{modelValue:z.value,"onUpdate:modelValue":e[2]||(e[2]=t=>z.value=t),rows:"5",style:{width:"100%"}},null,8,["modelValue"]),e[21]||(e[21]=s("label",null,"Alasan",-1))]),_:1}),l(k(A),{onClick:e[3]||(e[3]=t=>Q(V.value)),style:{"margin-top":"1rem"}},{default:S(()=>[l(i,{icon:"check"}),e[22]||(e[22]=p(" Kirim Jawaban"))]),_:1})]),_:1},8,["visible"])],64)}}}),at=re(Je,[["__scopeId","data-v-da6b2b51"]]);export{at as default};
