import{e as g,g as Z,r as c,i as ee,j as te,q as se,b as ae,c as u,k as a,w as m,l as i,F as B,o as r,a as t,T as ne,H as T,t as y,n as p,I as ie,h as C,p as oe}from"./index-CBwchtCO.js";import{a as $}from"./index-t--hEgTQ.js";import{d as re}from"./jwt-DHQMwwia.js";import{s as k}from"./index-BLW0Vhvl.js";import{h as U}from"./moment-C5S46NFB.js";import{s as le}from"./index-BGvGmQ9K.js";import{a as b,s as de}from"./index-Db3HylxY.js";import{s as ue}from"./index-DsHyVosY.js";import{s as P}from"./index-BV3ec3dk.js";import{t as I}from"./testModel-BhOHHhbN.js";import{t as me}from"./testSessionModel-BDz4YBbc.js";import{s as z}from"./index-Dl17GCaH.js";import{B as pe}from"./BaseWrapper-BVvZ9gme.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CGFOoBPZ.js";import"./index-C6q4XXx-.js";import"./index-ZdubDIuB.js";import"./index-DwCCTGtf.js";import"./index-k2ieuDwX.js";import"./index-CW3tOd1m.js";import"./index-DDeaUsRr.js";const K=()=>({getUserData:async l=>new Promise((f,o)=>{try{const x={id:l};$.post(`${g.baseEnd}/users/data/get`,x,{headers:g.headerSet}).then(w=>{f(w.data.data)}).catch(w=>{o(w.response.data.message)})}catch(x){o(x)}}),getUserActiveTestSession:async()=>new Promise((l,f)=>{try{$.get(`${g.baseEnd}/users/data/activesession`,{headers:g.headerSet}).then(o=>{l(o.data.data)}).catch(o=>{f(o.response.data.message)})}catch(o){f(o)}}),getUserProfile:async()=>new Promise((l,f)=>{try{$.get(`${g.baseEnd}/users/profile`,{headers:g.headerSet}).then(o=>{l(o.data.profile)}).catch(o=>{f(o.response.data.message)})}catch(o){f(o)}})}),fe={key:0,style:{display:"flex","flex-flow":"column","justify-content":"center","align-items":"center"}},ye={style:{margin:"0",padding:"0"}},ge={style:{margin:"0",padding:"0"}},ve={style:{"margin-top":"1rem"}},he=["src"],ke={key:1,src:"https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png?20150327203541",style:{"border-radius":"300px",width:"300px",height:"300px","object-fit":"cover"}},be={style:{"text-align":"center"}},xe={key:0},we={key:1,style:{display:"flex","flex-flow":"column","justify-content":"center","align-items":"center",width:"100%"}},_e={key:0,style:{display:"flex","flex-flow":"row wrap","justify-content":"center",width:"100%"}},Se=["index"],Ae={style:{margin:"0",padding:"0","text-align":"center"}},Te={key:0,style:{"text-align":"center","margin-top":"0.5rem","font-size":"16px",color:"orange"}},Ce={key:1,style:{"text-align":"center","margin-top":"0.5rem","font-size":"16px",color:"#888"}},De={style:{"text-align":"center","margin-top":"0.5rem","font-size":"12px",color:"#555",background:"#ddd",padding:"10px","padding-left":"2rem","padding-right":"2rem","border-radius":"10px",width:"fit-content"}},Me={key:0,style:{color:"red"}},$e={style:{display:"flex","flex-flow":"row nowrap","justify-content":"center","align-items":"center","margin-top":"1rem",gap:"0.5rem"}},Ue={style:{padding:"25px"}},Pe={style:{margin:"0"}},ze={key:0},je={key:1},Ve={key:1,style:{"font-size":"12px",color:"green"}},qe={key:1,style:{"text-align":"left",display:"block",margin:"0",padding:"0","margin-top":"1rem"}},Le={style:{display:"flex","flex-flow":"column"}},Be={style:{display:"flex","flex-flow":"column",width:"100%","box-sizing":"border-box","overflow-wrap":"break-word"}},Ie=["innerHTML"],Ke={style:{"text-align":"center"}},Ye=Z({__name:"ClientAssessment",setup(Y){const j=c(localStorage.getItem("authToken")||""),V=c(re(j.value)||{}),l=c({}),f=c([]),o=ee(),x=te(),w=()=>{K().getUserData(V.value.id).then(n=>{l.value=n}).catch(n=>{o.add({severity:"error",summary:"Kesalahan",detail:n,life:3e3})})},N=()=>{K().getUserActiveTestSession().then(n=>{f.value=n}).catch(n=>{o.add({severity:"error",summary:"Kesalahan",detail:n,life:3e3})})};se(()=>l.value,()=>{N()},{deep:!0});const _=c(!1),q=c(""),R=c([]),E=n=>{_.value=!0,q.value=n.description,R.value=n.questions},S=c(""),H=n=>{if(S.value=n._id,!n.isStarted){o.add({severity:"warn",summary:"Peringatan",detail:"Asesmen belum dibuka.",life:3e3});return}if(n.password.length>0){h.value=!0;return}D()},W=n=>{S.value=n,D()},F=()=>{if(!v.value){o.add({severity:"error",summary:"Kesalahan",detail:"Mohon masukkan sandi.",life:3e3});return}const n={id:S.value,password:v.value};I().verifyPassword(n).then(e=>{e.isCorrect?(v.value="",h.value=!1,D()):(o.add({severity:"error",summary:"Kesalahan",detail:"Sandi salah atau tidak valid.",life:3e3}),v.value="",h.value=!1)}).catch(e=>{o.add({severity:"error",summary:"Kesalahan",detail:e,life:3e3}),h.value=!1})},v=c(""),h=c(!1),D=()=>{x.require({message:"Apakah Anda yakin ingin memulai asesmen ini?",header:"Konfirmasi",icon:"pi pi-exclamation-triangle",acceptLabel:"Ya, Mulai",rejectLabel:"Tidak",acceptClass:"p-button-success",rejectClass:"p-button-secondary",accept:()=>{J()},reject:()=>{}})},A=c(!1),J=()=>{A.value=!0},O=()=>{const n={id:S.value};I().startAssesment(n).then(e=>{const d=e.session_token;localStorage.setItem("testToken",d),window.location.href="/assessment/session"}).catch(e=>{o.add({severity:"error",summary:"Kesalahan",detail:e,life:3e3})})},M=c([]),G=()=>{me().getUserSessions().then(n=>{M.value=n}).catch(n=>{})},Q=n=>{const e=new Date,d=U(n),s=U.duration(d.diff(e));return`0${s.hours()}:${s.minutes()}`.replace(/:0(\d)/,":$1")};return ae(()=>{w(),G()}),(n,e)=>{const d=oe("fasicon");return r(),u(B,null,[a(pe,null,{default:m(()=>[a(ne,{name:"slide-fade"},{default:m(()=>[Object.keys(l.value).length>0?(r(),u("div",fe,[e[14]||(e[14]=t("h1",{style:{margin:"0",padding:"0","font-size":"40px","text-align":"center"}},"Halo, Selamat Datang!",-1)),t("h2",ye,y(l.value.profile.name),1),t("div",null,[t("pre",ge,y(l.value.profile.email),1)]),t("div",ve,[l.value.profile.avatar?(r(),u("img",{key:0,src:`${i(g).baseUserContent}/${l.value.profile.avatar}`,style:{"border-radius":"250px",width:"250px",height:"250px","object-fit":"cover"}},null,8,he)):(r(),u("img",ke))]),t("div",null,[t("p",be,[e[6]||(e[6]=p("Instansi / Jurusan ")),e[7]||(e[7]=t("br",null,null,-1)),t("b",null,y(l.value.participant_instance.name),1),e[8]||(e[8]=p("   ·   ")),t("b",null,y(l.value.participant_data.jurusan)+" "+y(l.value.participant_data.kelas),1)])]),l.value.is_participant?(r(),u("div",we,[f.value.length>0?(r(),u("div",_e,[(r(!0),u(B,null,ie(f.value,(s,L)=>(r(),u("div",{class:"pneucard",index:L,style:{padding:"25px",width:"31%",display:"flex","flex-flow":"column","align-items":"center","background-color":"#eee"}},[a(d,{icon:"clipboard-list",style:{"font-size":"50px",color:"#000","text-align":"center","margin-bottom":"1rem"}}),t("h4",Ae,y(s.name),1),s.isStarted?(r(),u("span",Te,[t("b",null,[a(d,{icon:"check"}),e[9]||(e[9]=p(" Sudah Dibuka"))])])):(r(),u("span",Ce,e[10]||(e[10]=[t("b",null,"Belum Dibuka",-1)]))),t("div",De,[t("b",null,[a(d,{icon:"clock"}),p(" "+y(s.timeLimit)+" Menit",1)]),s.password.length>0?(r(),u("div",Me,[t("b",null,[a(d,{icon:"lock"}),e[11]||(e[11]=p(" Sesi Terkunci"))])])):T("",!0)]),t("div",$e,[a(i(k),{onClick:X=>E(s),style:{width:"fit-content","font-size":"12px"}},{default:m(()=>[a(d,{icon:"search"}),e[12]||(e[12]=p(" Detail Asesmen"))]),_:2},1032,["onClick"]),a(i(k),{disabled:!s.isStarted,onClick:X=>H(s),class:"p-button-success",style:{width:"fit-content","font-size":"12px"}},{default:m(()=>[a(d,{icon:"play"}),e[13]||(e[13]=p(" Mulai Asesmen"))]),_:2},1032,["disabled","onClick"])])],8,Se))),256))])):T("",!0)])):(r(),u("p",xe,"Mohon maaf, Anda bukan/belum menjadi peserta terdaftar. Silahkan laporkan kepada operator untuk mendaftar ke asesmen."))])):T("",!0)]),_:1}),t("div",Ue,[t("h2",Pe,[a(d,{icon:"history"}),e[15]||(e[15]=p(" Riwayat Asesmen Anda"))]),M.value.length>0?(r(),C(i(de),{key:0,value:M.value,style:{"margin-top":"1rem"}},{default:m(()=>[a(i(b),{field:"test.name",header:"Nama Asesmen"}),a(i(b),{field:"status",header:"Status"},{body:m(({data:s})=>[s.session.test_status=="completed"?(r(),C(d,{key:0,style:{color:"green"},icon:"check-circle"})):s.session.test_status=="in_progress"?(r(),C(d,{key:1,style:{color:"orange"},icon:"clock"})):T("",!0)]),_:1}),a(i(b),{field:"createdAt",header:"Dibuat Pada"},{body:m(({data:s})=>[t("span",null,y(i(U)(s.createdAt).format("ddd, DD MMM YYYY")),1)]),_:1}),a(i(b),{header:"Sisa Waktu"},{body:m(({data:s})=>[s.session.test_status!="completed"?(r(),u("span",ze,y(Q(s.session.end)),1)):(r(),u("span",je,"-"))]),_:1}),a(i(b),{header:"Soal Dikerjakan"},{body:m(({data:s})=>[t("span",null,y(s.session.state.current_question)+" Soal",1)]),_:1}),a(i(b),{header:"Aksi"},{body:m(({data:s})=>[s.session.test_status!="completed"?(r(),C(i(k),{key:0,onClick:L=>W(s.session.id_test),class:"p-button-success",style:{width:"fit-content","font-size":"12px"}},{default:m(()=>[a(d,{icon:"play"}),e[16]||(e[16]=p(" Lanjutkan"))]),_:2},1032,["onClick"])):(r(),u("span",Ve,[t("b",null,[a(d,{icon:"check"}),e[17]||(e[17]=p(" Selesai"))])]))]),_:1})]),_:1},8,["value"])):(r(),u("p",qe,"Anda belum memiliki riwayat asesmen. Asesmen Anda yang sedang berlangsung atau selesai akan muncul disini"))])]),_:1}),a(i(z),{visible:h.value,"onUpdate:visible":e[1]||(e[1]=s=>h.value=s),header:"Sesi Terkunci",style:{width:"25rem"},modal:""},{default:m(()=>[t("div",Le,[a(i(le),null,{default:m(()=>[e[18]||(e[18]=t("label",null,"Sandi",-1)),a(i(ue),{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s),type:"password",placeholder:"Masukkan Sandi Sesi",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(i(k),{onClick:F,style:{"margin-top":"1rem",width:"fit-content"}},{default:m(()=>[a(d,{icon:"check"}),e[19]||(e[19]=p(" Lanjutkan"))]),_:1})])]),_:1},8,["visible"]),a(i(z),{visible:_.value,"onUpdate:visible":e[3]||(e[3]=s=>_.value=s),header:"Detail Asesmen",style:{width:"60rem"},modal:"",maximizable:""},{default:m(()=>[e[20]||(e[20]=t("h4",{style:{color:"green",margin:"0",padding:"0"}},[t("b",null,"Deskripsi / Tata Tertib Asesmen")],-1)),t("div",Be,[t("div",{innerHTML:q.value,class:"rule-content"},null,8,Ie)]),a(i(P)),a(i(k),{label:"Tutup",onClick:e[2]||(e[2]=s=>_.value=!1),class:"p-button-secondary"})]),_:1},8,["visible"]),a(i(z),{visible:A.value,"onUpdate:visible":e[5]||(e[5]=s=>A.value=s),maximizable:"",modal:"",header:"Doa Sebelum Memulai Asesmen",style:{width:"35rem"}},{default:m(()=>[e[21]||(e[21]=t("div",{style:{"text-align":"center"}},[t("h3",{style:{margin:"0",padding:"0"}},"بِسْمِ اللَّهِ الرَّحْمَنِ الرَّحِيمِ"),t("p",{style:{margin:"0",padding:"0","font-size":"12px"}},"(Dengan nama Allah Yang Maha Pengasih, Maha Penyayang)")],-1)),a(i(P)),e[22]||(e[22]=t("p",{style:{margin:"0","margin-bottom":"1rem","text-align":"center","font-size":"20px"}},[p(" رَبِّ اشْرَحْ لِي صَدْرِي وَيَسِّرْ لِي أَمْرِي وَاحْلُلْ عُقْدَةً مِنْ لِسَانِي يَفْقَهُوا قَوْلِي"),t("br"),p(" Rabbisyrahlî shâdrî wayassyirlî amrI wahlul uqdatam mil-lisânî yafqahû qaulî."),t("br"),t("br"),p(' "Ya Tuhanku, lapangkanlah dadaku, mudahkanlah urusanku, dan lepaskanlah kekakuan dari lidahku, supaya mereka mengerti perkataanku" ')],-1)),a(i(P)),t("div",Ke,[a(i(k),{label:"Mulai Asesmen",onClick:e[4]||(e[4]=s=>{A.value=!1,O()}),class:"p-button-success"})])]),_:1},8,["visible"])],64)}}}),dt=ce(Ye,[["__scopeId","data-v-a2a285b7"]]);export{dt as default};
