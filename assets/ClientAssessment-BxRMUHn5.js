import{e as g,g as G,r as p,i as Q,j as X,q as Z,b as ee,c as u,k as a,w as c,l as r,F as L,o,a as s,T as te,H as A,t as y,n as f,I as se,h as C,p as ae}from"./index-DfPGng49.js";import{a as $}from"./index-t--hEgTQ.js";import{d as ne}from"./jwt-DHQMwwia.js";import{s as w}from"./index--RL2ZOfW.js";import{h as U}from"./moment-C5S46NFB.js";import{s as ie}from"./index-D6Y7zlXa.js";import{a as k,s as oe}from"./index-CD6AFDG7.js";import{s as re}from"./index-Bo-dvIuq.js";import{s as le}from"./index-9sMdTFS6.js";import{t as V}from"./testModel-kW2ESxZY.js";import{t as de}from"./testSessionModel-BoyBipDW.js";import{s as B}from"./index-9uu7ZcRe.js";import{B as ue}from"./BaseWrapper-nhkowgGI.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BSrnzhWS.js";import"./index-DI72dQsm.js";import"./index-CAG7Pnzt.js";import"./index-BNEW3akE.js";import"./index-7IxoaG3u.js";import"./index-CPLhAhYx.js";import"./index-DxDiYVdC.js";const K=()=>({getUserData:async l=>new Promise((m,i)=>{try{const b={id:l};$.post(`${g.baseEnd}/users/data/get`,b,{headers:g.headerSet}).then(_=>{m(_.data.data)}).catch(_=>{i(_.response.data.message)})}catch(b){i(b)}}),getUserActiveTestSession:async()=>new Promise((l,m)=>{try{$.get(`${g.baseEnd}/users/data/activesession`,{headers:g.headerSet}).then(i=>{l(i.data.data)}).catch(i=>{m(i.response.data.message)})}catch(i){m(i)}}),getUserProfile:async()=>new Promise((l,m)=>{try{$.get(`${g.baseEnd}/users/profile`,{headers:g.headerSet}).then(i=>{l(i.data.profile)}).catch(i=>{m(i.response.data.message)})}catch(i){m(i)}})}),me={key:0,style:{display:"flex","flex-flow":"column","justify-content":"center","align-items":"center"}},pe={style:{margin:"0",padding:"0"}},fe={style:{margin:"0",padding:"0"}},ye={style:{"margin-top":"1rem"}},ge=["src"],ve={key:1,src:"https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png?20150327203541",style:{"border-radius":"300px",width:"300px",height:"300px","object-fit":"cover"}},he={style:{"text-align":"center"}},ke={key:0},be={key:1,style:{display:"flex","flex-flow":"column","justify-content":"center","align-items":"center",width:"100%"}},_e={key:0,style:{display:"flex","flex-flow":"row wrap","justify-content":"center",width:"100%"}},we=["index"],xe={style:{margin:"0",padding:"0","text-align":"center"}},Se={key:0,style:{"text-align":"center","margin-top":"0.5rem","font-size":"16px",color:"orange"}},Ae={key:1,style:{"text-align":"center","margin-top":"0.5rem","font-size":"16px",color:"#888"}},Ce={style:{"text-align":"center","margin-top":"0.5rem","font-size":"12px",color:"#555",background:"#ddd",padding:"10px","padding-left":"2rem","padding-right":"2rem","border-radius":"10px",width:"fit-content"}},Te={key:0,style:{color:"red"}},De={style:{display:"flex","flex-flow":"row nowrap","justify-content":"center","align-items":"center","margin-top":"1rem",gap:"0.5rem"}},$e={style:{padding:"25px"}},Ue={style:{margin:"0"}},Me={key:0},je={key:1},ze={key:1,style:{"font-size":"12px",color:"green"}},Pe={key:1,style:{"text-align":"left",display:"block",margin:"0",padding:"0","margin-top":"1rem"}},Le={style:{display:"flex","flex-flow":"column"}},Ve={style:{display:"flex","flex-flow":"column",width:"100%","box-sizing":"border-box","overflow-wrap":"break-word"}},Be=["innerHTML"],Ke=G({__name:"ClientAssessment",setup(I){const M=p(localStorage.getItem("authToken")||""),j=p(ne(M.value)||{}),l=p({}),m=p([]),i=Q(),b=X(),_=()=>{K().getUserData(j.value.id).then(n=>{l.value=n}).catch(n=>{i.add({severity:"error",summary:"Kesalahan",detail:n,life:3e3})})},q=()=>{K().getUserActiveTestSession().then(n=>{m.value=n}).catch(n=>{i.add({severity:"error",summary:"Kesalahan",detail:n,life:3e3})})};Z(()=>l.value,()=>{q()},{deep:!0});const x=p(!1),z=p(""),N=p([]),Y=n=>{x.value=!0,z.value=n.description,N.value=n.questions},S=p(""),E=n=>{if(S.value=n._id,!n.isStarted){i.add({severity:"warn",summary:"Peringatan",detail:"Asesmen belum dibuka.",life:3e3});return}if(n.password.length>0){h.value=!0;return}T()},H=n=>{S.value=n,T()},R=()=>{if(!v.value){i.add({severity:"error",summary:"Kesalahan",detail:"Mohon masukkan sandi.",life:3e3});return}const n={id:S.value,password:v.value};V().verifyPassword(n).then(e=>{e.isCorrect?(v.value="",h.value=!1,T()):(i.add({severity:"error",summary:"Kesalahan",detail:"Sandi salah atau tidak valid.",life:3e3}),v.value="",h.value=!1)}).catch(e=>{i.add({severity:"error",summary:"Kesalahan",detail:e,life:3e3}),h.value=!1})},v=p(""),h=p(!1),T=()=>{b.require({message:"Apakah Anda yakin ingin memulai asesmen ini?",header:"Konfirmasi",icon:"pi pi-exclamation-triangle",acceptLabel:"Ya, Mulai",rejectLabel:"Tidak",acceptClass:"p-button-success",rejectClass:"p-button-secondary",accept:()=>{W()},reject:()=>{}})},W=()=>{const n={id:S.value};V().startAssesment(n).then(e=>{const d=e.session_token;localStorage.setItem("testToken",d),window.location.href="/assessment/session"}).catch(e=>{i.add({severity:"error",summary:"Kesalahan",detail:e,life:3e3})})},D=p([]),F=()=>{de().getUserSessions().then(n=>{D.value=n}).catch(n=>{})},J=n=>{const e=new Date,d=U(n),t=U.duration(d.diff(e));return`0${t.hours()}:${t.minutes()}`.replace(/:0(\d)/,":$1")};return ee(()=>{_(),F()}),(n,e)=>{const d=ae("fasicon");return o(),u(L,null,[a(ue,null,{default:c(()=>[a(te,{name:"slide-fade"},{default:c(()=>[Object.keys(l.value).length>0?(o(),u("div",me,[e[12]||(e[12]=s("h1",{style:{margin:"0",padding:"0","font-size":"40px","text-align":"center"}},"Halo, Selamat Datang!",-1)),s("h2",pe,y(l.value.profile.name),1),s("div",null,[s("pre",fe,y(l.value.profile.email),1)]),s("div",ye,[l.value.profile.avatar?(o(),u("img",{key:0,src:`${r(g).baseUserContent}/${l.value.profile.avatar}`,style:{"border-radius":"250px",width:"250px",height:"250px","object-fit":"cover"}},null,8,ge)):(o(),u("img",ve))]),s("div",null,[s("p",he,[e[4]||(e[4]=f("Instansi / Jurusan ")),e[5]||(e[5]=s("br",null,null,-1)),s("b",null,y(l.value.participant_instance.name),1),e[6]||(e[6]=f("   ·   ")),s("b",null,y(l.value.participant_data.jurusan)+" "+y(l.value.participant_data.kelas),1)])]),l.value.is_participant?(o(),u("div",be,[m.value.length>0?(o(),u("div",_e,[(o(!0),u(L,null,se(m.value,(t,P)=>(o(),u("div",{class:"pneucard",index:P,style:{padding:"25px",width:"31%",display:"flex","flex-flow":"column","align-items":"center","background-color":"#eee"}},[a(d,{icon:"clipboard-list",style:{"font-size":"50px",color:"#000","text-align":"center","margin-bottom":"1rem"}}),s("h4",xe,y(t.name),1),t.isStarted?(o(),u("span",Se,[s("b",null,[a(d,{icon:"check"}),e[7]||(e[7]=f(" Sudah Dibuka"))])])):(o(),u("span",Ae,e[8]||(e[8]=[s("b",null,"Belum Dibuka",-1)]))),s("div",Ce,[s("b",null,[a(d,{icon:"clock"}),f(" "+y(t.timeLimit)+" Menit",1)]),t.password.length>0?(o(),u("div",Te,[s("b",null,[a(d,{icon:"lock"}),e[9]||(e[9]=f(" Sesi Terkunci"))])])):A("",!0)]),s("div",De,[a(r(w),{onClick:O=>Y(t),style:{width:"fit-content","font-size":"12px"}},{default:c(()=>[a(d,{icon:"search"}),e[10]||(e[10]=f(" Detail Asesmen"))]),_:2},1032,["onClick"]),a(r(w),{disabled:!t.isStarted,onClick:O=>E(t),class:"p-button-success",style:{width:"fit-content","font-size":"12px"}},{default:c(()=>[a(d,{icon:"play"}),e[11]||(e[11]=f(" Mulai Asesmen"))]),_:2},1032,["disabled","onClick"])])],8,we))),256))])):A("",!0)])):(o(),u("p",ke,"Mohon maaf, Anda bukan/belum menjadi peserta terdaftar. Silahkan laporkan kepada operator untuk mendaftar ke asesmen."))])):A("",!0)]),_:1}),s("div",$e,[s("h2",Ue,[a(d,{icon:"history"}),e[13]||(e[13]=f(" Riwayat Asesmen Anda"))]),D.value.length>0?(o(),C(r(oe),{key:0,value:D.value,style:{"margin-top":"1rem"}},{default:c(()=>[a(r(k),{field:"test.name",header:"Nama Asesmen"}),a(r(k),{field:"status",header:"Status"},{body:c(({data:t})=>[t.session.test_status=="completed"?(o(),C(d,{key:0,style:{color:"green"},icon:"check-circle"})):t.session.test_status=="in_progress"?(o(),C(d,{key:1,style:{color:"orange"},icon:"clock"})):A("",!0)]),_:1}),a(r(k),{field:"createdAt",header:"Dibuat Pada"},{body:c(({data:t})=>[s("span",null,y(r(U)(t.createdAt).format("ddd, DD MMM YYYY")),1)]),_:1}),a(r(k),{header:"Sisa Waktu"},{body:c(({data:t})=>[t.session.test_status!="completed"?(o(),u("span",Me,y(J(t.session.end)),1)):(o(),u("span",je,"-"))]),_:1}),a(r(k),{header:"Soal Dikerjakan"},{body:c(({data:t})=>[s("span",null,y(t.session.state.current_question)+" Soal",1)]),_:1}),a(r(k),{header:"Aksi"},{body:c(({data:t})=>[t.session.test_status!="completed"?(o(),C(r(w),{key:0,onClick:P=>H(t.session.id_test),class:"p-button-success",style:{width:"fit-content","font-size":"12px"}},{default:c(()=>[a(d,{icon:"play"}),e[14]||(e[14]=f(" Lanjutkan"))]),_:2},1032,["onClick"])):(o(),u("span",ze,[s("b",null,[a(d,{icon:"check"}),e[15]||(e[15]=f(" Selesai"))])]))]),_:1})]),_:1},8,["value"])):(o(),u("p",Pe,"Anda belum memiliki riwayat asesmen. Asesmen Anda yang sedang berlangsung atau selesai akan muncul disini"))])]),_:1}),a(r(B),{visible:h.value,"onUpdate:visible":e[1]||(e[1]=t=>h.value=t),header:"Sesi Terkunci",style:{width:"25rem"},modal:""},{default:c(()=>[s("div",Le,[a(r(ie),null,{default:c(()=>[e[16]||(e[16]=s("label",null,"Sandi",-1)),a(r(re),{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=t=>v.value=t),type:"password",placeholder:"Masukkan Sandi Sesi",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(r(w),{onClick:R,style:{"margin-top":"1rem",width:"fit-content"}},{default:c(()=>[a(d,{icon:"check"}),e[17]||(e[17]=f(" Lanjutkan"))]),_:1})])]),_:1},8,["visible"]),a(r(B),{visible:x.value,"onUpdate:visible":e[3]||(e[3]=t=>x.value=t),header:"Detail Asesmen",style:{width:"60rem"},modal:"",maximizable:""},{default:c(()=>[e[18]||(e[18]=s("h4",{style:{color:"green",margin:"0",padding:"0"}},[s("b",null,"Deskripsi / Tata Tertib Asesmen")],-1)),s("div",Ve,[s("div",{innerHTML:z.value,class:"rule-content"},null,8,Be)]),a(r(le)),a(r(w),{label:"Tutup",onClick:e[2]||(e[2]=t=>x.value=!1),class:"p-button-secondary"})]),_:1},8,["visible"])],64)}}}),ot=ce(Ke,[["__scopeId","data-v-93017da8"]]);export{ot as default};
