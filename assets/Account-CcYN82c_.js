import{C as B}from"./ContentWrapper-Fzg6q2AN.js";import{e as h,d as E,f as N,Q as U,r as f,S,i as T,c as k,k as s,w as o,u as r,F,o as v,p as z,l as V,a as u,t as P,b as W,m as D}from"./index-BYjI3RzL.js";import{a as x}from"./index-t--hEgTQ.js";import{s as g,a as I}from"./index-BXZGvAi6.js";import{d as L}from"./jwt-DHQMwwia.js";import{s as M}from"./index-CxtTivIf.js";import{s as K}from"./index-gEKJ5veD.js";import{s as c}from"./index-U1r4huw_.js";import{s as y}from"./index-CFbT-i3X.js";import{s as Z}from"./index-DiTulTVF.js";import{F as G}from"./FloatingButton-BNuOT-xJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-C77anOhg.js";import"./index-JrDBRlSH.js";import"./index-CuRpGGED.js";import"./index-Bk9Gbc4E.js";import"./index-C2iUiu0F.js";import"./index-wCYQaIC3.js";const A=()=>({create:i=>new Promise((a,m)=>{x.post(`${h.baseEnd}/users/account/create`,i,{headers:h.headerSet}).then(d=>{a(d.data)}).catch(d=>{m(d.response.data.message)})}),get:i=>new Promise((a,m)=>{x.post(`${h.baseEnd}/users/account/get`,i,{params:i,headers:h.headerSet}).then(d=>{a(d.data.data)}).catch(d=>{m(d.response.data.message)})})}),J={style:{color:"darkorchid","text-transform":"uppercase","font-weight":"bold"}},Q={key:0,style:{"font-weight":"bold",color:"green"}},j={key:1},q={key:0},H={class:"flex flex-col gap-4"},O={style:{display:"flex","flex-flow":"column",gap:"1rem"}},ce=E({__name:"Account",setup(C){const l=N();U();const i=f(!1),a=f({name:"",email:"",phone:"",dob:"",password:"",confirmPassword:""}),m=f([]),d=()=>{if(!a.value.name||a.value.name.trim()===""){l.add({severity:"error",summary:"Kesalahan",detail:"Nama tidak boleh kosong",life:2e3});return}if(!/^[a-zA-Z\s]+$/.test(a.value.name)){l.add({severity:"error",summary:"Kesalahan",detail:"Nama hanya boleh mengandung huruf dan spasi",life:2e3});return}if(!a.value.email||a.value.email.trim()===""){l.add({severity:"error",summary:"Kesalahan",detail:"Email tidak boleh kosong",life:2e3});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.value.email)){l.add({severity:"error",summary:"Kesalahan",detail:"Email tidak valid",life:2e3});return}if(!a.value.password||a.value.password.trim()===""){l.add({severity:"error",summary:"Kesalahan",detail:"Password tidak boleh kosong",life:2e3});return}if(a.value.password.length<8){l.add({severity:"error",summary:"Kesalahan",detail:"Password harus minimal 8 karakter"});return}if(!/[A-Z]/.test(a.value.password)){l.add({severity:"error",summary:"Kesalahan",detail:"Password harus mengandung setidaknya satu huruf kapital",life:2e3});return}if(!/[a-z]/.test(a.value.password)){l.add({severity:"error",summary:"Kesalahan",detail:"Password harus mengandung setidaknya satu huruf kecil",life:2e3});return}if(!/[0-9]/.test(a.value.password)){l.add({severity:"error",summary:"Kesalahan",detail:"Password harus mengandung setidaknya satu angka",life:2e3});return}if(!/[!@#$%^&*(),.?":{}|<>]/.test(a.value.password)){l.add({severity:"error",summary:"Kesalahan",detail:"Password harus mengandung setidaknya satu karakter khusus",life:2e3});return}if(!a.value.confirmPassword||a.value.confirmPassword.trim()===""){l.add({severity:"error",summary:"Kesalahan",detail:"Konfirmasi password tidak boleh kosong",life:2e3});return}if(a.value.password!==a.value.confirmPassword){l.add({severity:"error",summary:"Kesalahan",detail:"Password dan konfirmasi password tidak cocok",life:2e3});return}A().create(a.value).then(n=>{n.status===200?(l.add({severity:"success",summary:"Akun berhasil dibuat",detail:"Akun baru telah berhasil dibuat.",life:2e3}),a.value={name:"",email:"",phone:"",dob:"",password:"",confirmPassword:""},i.value=!1,b()):l.add({severity:"error",summary:"Gagal membuat akun",detail:n.message,life:2e3})}).catch(n=>{l.add({severity:"error",summary:"Kesalahan",detail:n,life:2e3})})},p=f({id:"",role:""}),w=f(""),b=()=>{const n={search_key:w.value};A().get(n).then(e=>{m.value=e}).catch(e=>{m.value=[]})};S(()=>w.value,()=>{b()}),T(()=>{b();const n=localStorage.getItem("authToken");if(n){const e=L(n);p.value.id=e.id,p.value.role=e.role}else p.value.id="",p.value.role=""});const _=()=>{window.location.href="/profile"};return(n,e)=>{const $=D("fasicon");return v(),k(F,null,[s(B,{"content-title":"Kelola Akun","content-hint":"Pengguna Webmaster yang terdaftar di sistem"},{default:o(()=>[s(r(y),null,{default:o(()=>[e[7]||(e[7]=u("label",null,"Cari Pengguna",-1)),s(r(c),{style:{width:"300px"},modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=t=>w.value=t),placeholder:"Kata kunci..."},null,8,["modelValue"])]),_:1}),s(r(Z)),m.value.length>0?(v(),z(r(I),{key:0,value:m.value,paginator:!0,rows:10},{default:o(()=>[s(r(g),{header:"ID"},{body:o(({data:t})=>[u("span",null,[u("code",J,"#"+P(t._id),1)])]),_:1}),s(r(g),{header:"Nama"},{body:o(({data:t})=>[t._id==p.value.id?(v(),k("span",Q,P(t.name)+" (Anda)",1)):(v(),k("span",j,P(t.name),1))]),_:1}),s(r(g),{field:"email",header:"Email"}),s(r(g),{header:"Aksi"},{body:o(({data:t})=>[t._id==p.value.id?(v(),k("div",q,[s(r(K),{label:"Edit",onClick:_})])):V("",!0)]),_:1})]),_:1},8,["value"])):V("",!0)]),_:1}),s(G,{onClick:e[1]||(e[1]=t=>i.value=!0)}),s(r(M),{visible:i.value,"onUpdate:visible":e[6]||(e[6]=t=>i.value=t),modal:"",header:"Buat Akun Baru",style:{width:"30rem"},draggable:!1,maximizable:!0},{default:o(()=>[u("div",H,[u("div",O,[s(r(y),null,{default:o(()=>[e[8]||(e[8]=u("label",null,"Nama Lengkap",-1)),s(r(c),{modelValue:a.value.name,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.name=t),style:{width:"100%"},type:"text",class:"p-inputtext p-component w-full"},null,8,["modelValue"])]),_:1}),s(r(y),null,{default:o(()=>[e[9]||(e[9]=u("label",{for:"email"},"Email",-1)),s(r(c),{style:{width:"100%"},id:"email",modelValue:a.value.email,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.email=t),type:"text",class:"p-inputtext p-component w-full"},null,8,["modelValue"])]),_:1}),s(r(y),null,{default:o(()=>[e[10]||(e[10]=u("label",{for:"password"},"Password",-1)),s(r(c),{style:{width:"100%"},id:"password",modelValue:a.value.password,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.password=t),type:"password",class:"p-inputtext p-component w-full"},null,8,["modelValue"])]),_:1}),s(r(y),null,{default:o(()=>[e[11]||(e[11]=u("label",{for:"confirmPassword"},"Konfirmasi Password",-1)),s(r(c),{style:{width:"100%"},id:"confirmPassword",modelValue:a.value.confirmPassword,"onUpdate:modelValue":e[5]||(e[5]=t=>a.value.confirmPassword=t),type:"password",class:"p-inputtext p-component w-full"},null,8,["modelValue"])]),_:1}),s(r(K),{style:{width:"fit-content"},onClick:d},{default:o(()=>[s($,{icon:"plus"}),e[12]||(e[12]=W(" Buat Akun"))]),_:1})])])]),_:1},8,["visible"])],64)}}});export{ce as default};
